<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@ViewBag.Title</title>
    <link rel="shortcut icon" href="@Url.Content("~/Content/images/favicon.png")">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    @RenderSection("nlFormContent", false)
    @if (RevenuePlanner.Helpers.Common.IsDebug)
    {
        <link rel="stylesheet" href="@Url.Content("~/Content/css/bootstrap.css")" type="text/css" />
        <link rel="stylesheet" href="@Url.Content("~/Content/css/bootstrap-responsive.css")" type="text/css" />
        <link rel="stylesheet" href="@Url.Content("~/Content/css/style.css")" type="text/css" />
        <link rel="stylesheet" href="@Url.Content("~/Content/css/datepicker.css")" type="text/css" />
        <link rel="stylesheet" href="@Url.Content("~/Content/css/style_extended.css")" type="text/css" />
        <link rel="stylesheet" href="@Url.Content("~/Content/css/tipsy.css")" type="text/css" />
        <link href="@Url.Content("~/Content/css/DHTMLX/dhtmlxgantt.css")" rel="stylesheet">
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
		<script src=""@Url.Content("~/Scripts/js/html5shiv.js")"></script>
		<![endif]-->    
        <script src="@Url.Content("~/Scripts/js/DHTMLX/dhtmlxgantt.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.min.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery-migrate-1.2.1.min.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/bootstrap.min.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.slimscroll.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.slidepanel.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/scripts.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/scripts_extended.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.form.min.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/bootstrap-datepicker.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.price_format.1.8.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.price_format.1.8.min.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/slimScrollHorizontal.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.tipsy.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.selectbox-0.2.js")"></script>
        
        @* Start - Added by :- uday on 27/05/2014 for PL #453*@
       <link rel="stylesheet" href="@Url.Content("~/Content/css/font-awesome.min.css")" type="text/css">
       <script type="text/javascript" src="@Url.Content("~/Scripts/modernizr-2.5.3.js")"></script>
       <!-- include summernote css/js-->
       <link rel="stylesheet" href="@Url.Content("~/Content/css/summernote.css")" type="text/css" />
       <script type="text/javascript" src="@Url.Content("~/Scripts/summernote.min.js")"></script>
        @* end - Added by :- uday on 27/05/2014 for PL #453 *@
    }
    else
    {
        <link rel="stylesheet" href="@Url.Content("~/Content/css/bootstrap.min.css")" type="text/css" />
        <link rel="stylesheet" href="@Url.Content("~/Content/css/bootstrap-responsive.css")" type="text/css" />
        <link rel="stylesheet" href="@Url.Content("~/Content/css/style.css")" type="text/css" />
        <link rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap.datepicker/0.1/css/datepicker.css" type="text/css" />
        <link rel="stylesheet" href="@Url.Content("~/Content/css/style_extended.css")" type="text/css" />
        <link rel="stylesheet" href="//cdn.jsdelivr.net/tipsy/1.0/stylesheets/tipsy.css" type="text/css" />
        <link href="@Url.Content("~/Content/css/DHTMLX/dhtmlxgantt.css")" rel="stylesheet">
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
		<script src="//cdn.jsdelivr.net/html5shiv/3.6.2/html5shiv.js"></script>
		<![endif]-->    
        <script src="@Url.Content("~/Scripts/js/DHTMLX/dhtmlxgantt.js")"></script>
        <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.0.min.js"></script>
        <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.migrate/jquery-migrate-1.2.1.min.js"></script>
        <script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/2.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.slimscroll.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.slidepanel.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/scripts.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/scripts_extended.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.form.min.js")"></script>
        <script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.datepicker/0.1/js/bootstrap-datepicker.js"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/jquery.price_format.1.8.min.js")"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/js/slimScrollHorizontal.js")"></script>
        <script type="text/javascript" src="//cdn.jsdelivr.net/tipsy/1.0/javascripts/jquery.tipsy.js"></script>
        <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.selectbox-0.2.js")"></script>
        
       @* Start - Added by :- uday on 27/05/2014 for PL #453*@ 
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
        <script type="text/javascript" src="http://cdn.jsdelivr.net/modernizr/2.8.2/modernizr.min.js"></script>
        <!-- include summernote css/js-->
        <link href="//oss.maxcdn.com/summernote/0.5.1/summernote.css" rel="stylesheet">
        <script src="//oss.maxcdn.com/summernote/0.5.1/summernote.min.js"></script>
        @* end - Added by :- uday on 27/05/2014 for PL #453 *@
    }
</head>
<body>
    <div class="container-fluid all-height">
        @{
            string a = Convert.ToString(ViewBag.ActiveMenu);
            if (a == null)
            {
                a = "a";
            }
            else
            {
                a = a.ToLower();
            }
        }
        @Html.Hidden("ActiveMenu", a)
        <div class="row-fluid">
            @Html.Partial("_header")
        </div>
        <div class="row-fluid calc-height">
            <div id="sidebar" class="span2">
                @RenderSection("Sidebar", false)
            </div>
            <div id="content_wraper" class="span10 all-height">
                @RenderBody()
            </div>
        </div>
    </div>
    <div id="slidepanel" class="sidebar-form source-sans-proregular scrolled_div_form panel_right loading" style="display: none">
        <div id="slidepanel-container">
        </div>
    </div>
    <!--End sidebar-->
    <div id="div_contactSupport"></div>
    <span class="functioncallselector"></span>
</body>
</html>
@RenderSection("Scripts", false)
<script type="text/javascript">
    $.ajaxSetup({
        cache: false
    });
    var isAlerted = false;
    $(document).ready(function () {
        $(window).attr('name', '@RevenuePlanner.Helpers.Sessions.User.UserId');
        $('#ContactSupport').click(function () {
            $("#div_contactSupport").empty();
            var url = '@Url.Content("~/Common/LoadSupportPartial/")';   //// Modified by Sohel Pathan on 23/05/2014 for internal review points.
            $("#div_contactSupport").load(url);
        });

        switch ($('#ActiveMenu').val().toString().toLowerCase()) {
            case 'home':
                $('.home').addClass('active');
                break;
            case 'model':
                $('.model').addClass('active');
                break;
            case 'plan':
                $('.plan').addClass('active');
                break;
            case 'boost':
                $('.boost').addClass('active');
                break;
            case 'report':
                $('.report').addClass('active');
                break;
            case 'pref':
                $('.pref').addClass('active');
                break;
            default:
                $('.home').addClass('active');
                break;
        }


    });
    $(".alert").find(".close").on("click", function (e) {
        e.stopPropagation();
        e.preventDefault();
        $(this).closest(".alert").slideUp(300);
    });
    $.ajaxSetup({
        beforeSend: function (x) { //Called before every request
            myApp.showPleaseWait();
        },
        statusCode: {
            403: function () {
                myApp.hidePleaseWait();
                //this will catch any and all access denied errors
                if (isAlerted == false) {
                    isAlerted = true;
                    alert("Sorry, your session has expired. Please login again by clicking on Ok button.");
                    window.location = "@Url.Content("~/login/Index")";
                }
            }
        },
        error: function (x, e) { // Called when error occured
            GoToLogin();
        }
    });
   
    function GoToLogin() {
        myApp.hidePleaseWait();
        //In case of error and it is due to session timed out -  the above code was not working in case of div.load, used to display slidepanel
        var IsSessionExist = readCookie('IsSessionExist');
        if (IsSessionExist == 0 && isAlerted == false) {
            isAlerted = true;
            alert("Sorry, your session has expired. Please login again by clicking on Ok button.");
            window.location = "@Url.Content("~/login/Index")";
        }
    }
    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }
    $(document).ajaxStop(function () { //Called after every ajax request completed
        myApp.hidePleaseWait();
    });
    var reason = 'user';
    function CheckUserSession(Sender, isSender) {
        $.ajax({
            type: 'GET',
            url: '@Url.Content("~/Home/CheckUserId/")?UserId=' + $(window).attr('name'),
            success: function (data) {
                reason = 'callback';
                if (data.returnURL == '#') {
                    if (isSender) {
                        $(Sender).click();
                    }
                    else {
                        
                    }
                }
                else {
                    window.location = data.returnURL;
                }
            }
        });
    }
    
    var myApp;
    myApp = myApp || (function () {
        var pleaseWaitDiv = $('<div style="z-index:99999" class="modal hide" id="pleaseWaitDialog" data-backdrop="static" data-keyboard="false"><div class="modal-header">Please wait...</div><div class="modal-body"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div></div>');
        return {
            showPleaseWait: function () {
                pleaseWaitDiv.modal();
            },
            hidePleaseWait: function () {
                pleaseWaitDiv.modal('hide');
            },

        };
    })();
</script>
