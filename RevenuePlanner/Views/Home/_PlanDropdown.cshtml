@model RevenuePlanner.Models.HomePlan
@using RevenuePlanner.Helpers;

<ul class="nav nav-tabs" style="margin-left:25px;">
    <li class="title-header source-sans-proregular bold font-size25px" style="padding-top:5px;">
      @* @if (Model.plans != null && Model.plans.Count > 0)
       {
        <form id="nl-form2" class="nl-form-plan-title without-margin plantitle" style="display:none;">

            <select id="dropdown-plan-title" data-default="0%" class="" maxlength="40" style="display:none;" >
                <script>
                    var plan = @Html.Raw(Json.Encode(Model.plans))
                    populateNF(plan, "dropdown-plan-title");
                </script>
            </select>
            <div class="nl-overlay"></div>
            <script>
                var nlform = new NLForm(document.getElementById('nl-form2'));
            </script>

        </form>
       }*@
         <h2 id="lblMarkringActivitiestitle" style="font-size: 23px;display:none;">Marketing Activities</h2>
    </li>
   

    <li style="padding-top:5px;" id="liplanrequest">
        <div class="request-icons hide">
		     <div class="request-icon-block"><a href="#" class="request">Request<span class="counter badge"></a></span></div>
            <div class="request-icon-block"><a href="#" class="new-btn-plan request-btn-active">Plan</a></div>
	    </div>
    </li>
    
         <div style="float: right;margin-bottom: 10px; margin-right: -15px;" id="divupcomingact">
                @Html.Label("Time Frame:", new { id = "lblUpcoming_Activies" })    @* Modified by : Sohel Pathan on 29/10/2014 for PL ticket #899 *@
            <span class="selectBox" id="ddlUpComingActivitesSelectBox" style="width: 127px;">
                @Html.DropDownList("ddlUpComingActivites", new SelectList((System.Collections.IEnumerable)ViewBag.ViewUpComingActivity, "Value", "Text",DateTime.Now.Year.ToString()), new { @class = "hide" })
            </span>
            @Html.Label("View By:", new { id = "lblViewBy" })
            @Html.DropDownList("ddlTabViewBy", new SelectList((System.Collections.IEnumerable)ViewBag.ViewByTab, "Value", "Text", @RevenuePlanner.Helpers.PlanGanttTypes.Tactic.ToString()), new { @class = "hide" })
        </div>
</ul>
@*<script src="~/Scripts/js/scripts.js"></script>*@
<script type="text/javascript">
    $(document).ready(function () {
        $(".selectBox select").selectbox();
        $("#ddlTabViewBy").multiselect({
            multiple: false,
            noneSelectedText: "Please Select",
            selectedList: 1,
            CustomCampaignName: "@Common.CampaignCustomTitle",
            CustomProgramName: "@Common.ProgramCustomTitle",
            CustomTacticName: "@Common.TacticCustomTitle",
            classes: 'custom-right-pos', // Added by Sohel Pathan on 11/11/2014 for PL ticket #934, NOTE : Please don't change class name, it is used in js.
            IsTacticSection: "TACTIC SECTION"
        }).multiselectfilter({
            CustomCampaignName: "@Common.CampaignCustomTitle",
            CustomProgramName: "@Common.ProgramCustomTitle",
            CustomTacticName: "@Common.TacticCustomTitle",
        });
        var Currenttime = $('#ddlUpComingActivites').val();
        isQuater = Currenttime;
        onClickPlanTitle();
        SetAttributeData();

        RefreshCurrentTab();
        if ($('#IsGridView').val() == "True") {
            $("#CalenderView").hide();
        }
        if (activeMenu == '@Enums.ActiveMenu.Plan.ToString().ToLower()') {
            GetCollaborators(CurrentPlanId);
            $("#lblMarkringActivitiestitle").show();
           // $("#nl-form2").show();
        }
        else {
          //  $("#nl-form2").hide();
          
        }
        $('.request-icons').show();
        var SelectedPlans = filters.SelectedPlans.toString();
        GetHealderData(SelectedPlans);
        GetNumberOfActivityPerMonByPlanId(SelectedPlans, Currenttime);
    });

    $("#ddlTabViewBy").change(function () {
        requestPlanActiveTab(false);
        RefreshCurrentTab();
    });
    $('.new-btn-plan').click(function () {
        $("#ddlTabViewBy").find("option[value= @PlanGanttTypes.Tactic.ToString()]").prop("selected", "selected");
        $("#ddlTabViewBy").multiselect('refresh');
        $("#ddlTabViewBy").trigger('change');
        requestPlanActiveTab(false);
        //Modified by komal rawal for #1283
        $(".sidebar-section #ulTacticType").find(' li .TacticNumber').each(function () {
            var oldvalue = $(this).attr("Previousvalue");
            var setvalue = $(this).html(oldvalue);
    });
    });
    $('.request').click(function () {
        isRequest = true;
        requestPlanActiveTab(isRequest);
        getViewByList = true;
        RefreshCurrentTab();
        //Modified by komal rawal for #1283
        $(".sidebar-section #ulTacticType").find(' li .TacticNumber').each(function () {
            var setvalue = $(this).html("0");
        });
    });


    $("#ddlUpComingActivites").change(function () {
        var TempPlanIds ;
        if (activeMenu == '@Enums.ActiveMenu.Plan.ToString().ToLower()') {
            TempPlanIds = CurrentPlanId;
        }
        else {
            TempPlanIds = filters.SelectedPlans.toString();
        }
        
            Currenttime = $('#ddlUpComingActivites').val();
            isQuater = Currenttime;
            RefreshCurrentTab();
            GetHealderData(TempPlanIds);
            GetNumberOfActivityPerMonByPlanId(TempPlanIds, Currenttime);
    });

    $('.sbHolder').click(function () {
        $("#ddlTabViewBy").multiselect("close");//"Close" is function in multiselect.js which close the multiselect menu 
    });

    // Start - Added by Sohel Pathan on 06/11/2014 for PL ticket #934
    $('.selectBox').click(function () {
        $('#ddlTabViewBy').multiselect("close");
    });
    // End - Added by Sohel Pathan on 06/11/2014 for PL ticket #934
    function requestPlanActiveTab(isRequestTab) {
        if (isRequestTab) {
            $('.new-btn-plan').removeClass('request-btn-active');
            $('.request').addClass('request-btn-active');
        }
        else {
            $('.new-btn-plan').addClass('request-btn-active');
            $('.request').removeClass('request-btn-active');
        }
    }
</script>

