@using RevenuePlanner.Helpers
@{
    ViewBag.Title = "IndexNew1";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@* Sidebar Section Start *@

@section Sidebar{
<div id="divFilter"></div>
}


<script type="text/javascript" src="~/Scripts/Planhud.js"></script>

@* ================= Header section start ==================  *@
<div class="cf full-width-header" id="planHeader">
    @Html.Partial("~/Views/Shared/_Planhud.cshtml")
    <div class="planheader-left">
        <div class="plan-header-grid">
            <div class="request-icon-block">
                <a class="new-btn-plan-left P-icon-active" href="#">
                    <i class="fa fa-calendar"></i>
                </a>
                <a id="btngrid" class="new-btn-plan-right" href="#">
                    <i class="fa fa-money"></i>
                </a>
            </div>
            <div class="ix-icon-block margin-left8 ">
                <a class="new-btn-plan-left P-icon-active" href="#">
                    <i class="fa fa-sign-in"></i><span>Import</span>
                </a>
                <a href="#" id="" class="new-btn-plan-right dropdown-toggle " data-toggle="dropdown">
                    <i class="fa fa-external-link"></i><span>Export</span>
                </a>
                <ul id="" class="dropdown-menu export-dd">
                    <li title=""><a href="#">.csv</a></li>
                    <li title=""><a href="#">PDF</a></li>
                </ul>
            </div>

            <!-- -->
            <div id="divupcomingact" class="viewby-wrap margin-left9">
                <label id="lblUpcoming_Activies1" for="Time_Frame:">Time Frame:</label>
                <span style="width: 100px;" id="ddlUpComingActivitesSelectBox" class="selectBox">
                    <select name="ddlUpComingActivites" id="ddlUpComingActivites" class="hide" sb="85765995" style="display: none;">
                        <option value="2016" selected="selected">2016</option>
                        <option value="thismonth">this month</option>
                        <option value="thisquarter">this quarter</option>
                    </select>
                </span>
            </div>
            <div class="viewby-wrap">
                <label id="lblViewBy1" for="View_By:">View By:</label>
                <button id="btnMultiselect_ddlTabViewBy" type="button" class="ui-multiselect ui-widget ui-state-default ui-corner-all custom-right-pos" aria-haspopup="true" title="Tactic">
                    <span>Tactic</span><span class="ui-icon ui-icon-triangle-1-s"></span>
                </button>
            </div>
            <!-- -->
        </div>
    </div>
                </div>
@* ================= Header section End ==================  *@
@* ================= Grid box start here ================= *@
<div class="task-tbl">
    <div class="gridbox-wrapper" style="width: 100%; height: 400px; border:1px solid #ccc; margin:0 0 10px 0">
        Grid is coming here

    </div>

    <div id="ImprovementGrid" class="improvement-grid-wrapper">
        Improvement Activity coming here
    </div>
</div>   
    <script type="text/javascript">
        $('.sidebar-toogle a').toggle(
        function () {
            $('#sidebar').css({
                'position': 'relative',
                'left': 'auto',
                'width': '1px',
                'background': 'transparent',
            });

            $(".sidebar-section").css("display", "none");
            $("#improvements > .accordion-group").css('display', 'none');
            $(".wraper-btns").css("display", "none");
            $("#content_wraper").css('width', 'calc(100% - 2px)');
            $('#sidebar.sidebar').css({ 'width': '1px', 'background': 'transparent', });

        },
        function () {
            $('#sidebar').css({
                'position': 'static',
                'left': 'auto',
                'width': '280px',
            });

            $(".sidebar-section").css("display", "block");
            $(".wraper-btns").css("display", "block");
            $("#content_wraper").css('width', 'calc(100% - 282px)');
            $('#sidebar.sidebar').css({ 'width': '280px' });

        }
  )
        $(document).ready(function () {
            $(".selectBox select").selectbox();
            $("#ddlTabViewBy").multiselect();

        var strURL = '@Url.Content("~/Filter/Index/")';
        $.ajax({
            url: strURL,
            type: 'post',
            dataType: 'html',
            async: false,
            data: {
                activeMenu: '@Enums.ActiveMenu.Home',
                CurrPlanIds: '@Sessions.PlanPlanIds'
            },
            success: function (data) {
                if (data != 'undefined' && data != null) {
                    $('#divFilter').html(data);
                    var planids = [];
                    $('#ulSelectedPlans').find("input[type=checkbox]").each(function () {

                        if ($(this).attr('checked') == 'checked') {
                            var chkid = $(this).attr("id");
                            var Value = $(this).attr("planTitle");
                            if (chkid != undefined && chkid != 'undefined') {
                                planids.push(chkid);
                            }
                        }
                    });

                    GetTacticTypelist(planids);
                    GetOwnerListForFilter(planids);
                    GetLastSetofViews($('#FilterPresetName').val());
                    var SelectedTimeFrameOption = $('#ddlUpComingActivites').val();
                    GetHeadsUpData('@Url.Action("GetHeaderforPlanByMultiplePlanIDs", "Plan")', '@Url.Action("GetActivityDistributionchart", "Home")', '@Enums.ActiveMenu.Home.ToString().ToLower()', SelectedTimeFrameOption)
                    GetMultiplePlanNames();

                    LoadImprovementGrid('@Sessions.PlanPlanIds');
                }
            }
        });
    })

    function LoadImprovementGrid(PlanID) {
        $.ajax({
            beforeSend: function (x) {
                myApp.hidePleaseWait();
            },
            url: '@Url.Content("~/Plan/LoadImprovementGrid/")',
            data: {
                id: PlanID
            },
            success: function (result) {
                $("#ImprovementGrid").html('');
                $("#ImprovementGrid").html(result);
            }
        });
    }
</script>

