@using RevenuePlanner.Models
@using RevenuePlanner.Helpers
@{
    string SelectedYear = ViewBag.SelectedYear;
    //var ViewPlanSelectedValue = (List<SelectListItem>)ViewBag.ViewPlan;
    List<RevenuePlanner.Models.PlanListModel> planList = ViewBag.ViewPlan;
    var ViewYearList = (List<SelectListItem>)ViewBag.ViewYear;
    // Start - Added by Arpita Soni on 01/19/2015 for Ticket #1148 
    var ViewCustomFields = (List<RevenuePlanner.Models.CustomField>)ViewBag.ViewCustomFields;
    var ViewCustomFieldOptions = (List<RevenuePlanner.Models.CustomFieldOption>)ViewBag.ViewCustomFieldOptions;
    // End - Added by Arpita Soni on 01/19/2015 for Ticket #1148 
    string FilterName = Sessions.FilterPresetName;
    string _monthly = Enums.ViewByAllocated.Monthly.ToString();
    string _quarterly =  Enums.ViewByAllocated.Quarterly.ToString();
    ViewBag.Title = "Summary";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var PageTitle = "Reports";
    List<Custom_Dashboard> DashboardList = ViewBag.DashboardList;
    // Add By Nishant Sheth // Desc :: Add Dimension id and dimension value attribute in checkbox list
    List<Dimension> ListDimension = ViewBag.ListDimension;
    List<DimensionValue> ListDimensionVaule = ViewBag.ListDimensionVaule;
    var OwnerDimensionId= ListDimension.Where(a=>a.Name==Enums.Dimension.CreatedBy.ToString()).Select(a=>a.id).FirstOrDefault();
    var OwnerDimensionList = ListDimensionVaule.Where(a => a.DimensionID == OwnerDimensionId).Select(a => new { Value= a.Value, Id = a.id.ToString() }).ToList();
    var TacticTypeDimensionId = ListDimension.Where(a => a.Name == Enums.Dimension.TacticTypeId.ToString()).Select(a => a.id).FirstOrDefault();
    var TacticTypeDimensionList = ListDimensionVaule.Where(a => a.DimensionID == TacticTypeDimensionId).Select(a => new { Value = a.Value, Id = a.id.ToString() }).ToList();
    // End By Nishant Sheth
}
@Html.Hidden("PageTitle", PageTitle)
@Html.Hidden("FilterName", FilterName)
@Scripts.Render("~/bundles/GetJSReport")
<link rel="stylesheet" href="@Url.Content("~/Content/css/jquery.mCustomScrollbar.css")" type="text/css" />
<style type="text/css">
    .simpleSelectBox .sbHolder {
        width: 10% !important;
    }

    .h3budget {
        padding-top: 0px !important;
    }

    .ui-multiselect {
    max-width:120px !important;
    }
    .chkbxfilter {
        float: right;   /*#2055 again removed top margin for allignment 21-3-2016 */     
    }
    
    .singleselect li {
        cursor:pointer;
    }
     /*Added by Maitri Gandhi on 25/2/2016 for #1952 observation*/
    #accordion-SelectedFilter .singleselect li {
        cursor: text;
    }
    .margin_top20 {
        margin-top:20px;
    }
    #ulLeftPane li {
        cursor:pointer;
    }
    .table-striped2 table td:nth-child(2),td:nth-child(3),td:nth-child(4){ text-align:center !important;}
    .ddlQuarter .selectBox .sbSelector{
        font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
        /*font-size: 14px;*/
        color: #6d6d6d !important;
    }
    .budgeting-linechart {
    padding: 0 75px;
    text-align: center;
}
    .nobold {
        font-weight:inherit !important;
    }    
     #accordion-SelectedFilter .accordion-group
    {
        margin-bottom:0 !important;
    }


</style>

@section Sidebar
{
@*modified by Rahul Shah for Pl #1837*@
<div class="save-filter">
    <!--error message-->
    <div id="errorMessageMainSidebar" class="alert hide alert-error">
        <a class="close">×</a>
        <strong></strong><span id="spanErrorMessageRole"></span>
    </div>

    <!--error message-->

    <div id="successMessageLoadPreset" class="alert hide alert-success">
        <a class="close">×</a>
        <div id="cSuccess"><span id="spanSuccessMessageRole"></span></div>
    </div>
    <div id="content_SaveFilters" class="sidebar-preset scroll-section" style="height: 456.85px; display:none">
        <h2>Save As Preset</h2>
        <label for="Preset">Please enter a name for preset</label>
        <input type="text" id="txtPresetName" />
        <input type="button" class="btn btn-blue text-shadow-blue source-sans-proregular" title="Proceed" value="Proceed" id="btnSaveProceed" onclick="javascript: SavePreset()" />
        <input type="button" class="btn btn-link" title="Cancel" value="Cancel" id="btnSaveCancel" onclick="javascript: CancelSavePreset()" />
    </div>
    <div id="DefaultFilters" style="display:none"></div>
</div>
    @*Add By Nishant Sheth 
    // Desc :: #1958 Add hide icon to hide side bar*@
<div class="padding-content padding-bottom0 sidebar-toogle-wrapper" id="divsidebartoggle">
    <div class="sidebar-toogle">
        <a href="#">&nbsp;<span><< hide</span></a>
    </div>
</div>
    <div class="padding-content padding-bottom0 sidebar-toogle-wrapper" id="btnreportSection">

        <h4 class="text-shadow-black source-sans-prolight">Reports</h4>
        <div class="wraper-btns cf">
            
                @if ((bool)ViewBag.TacticActualsAddEdit) // Added by Sohel Pathan on 27/06/2014 for PL ticket #537 to implement user permission Logic
                {  // Modified by Arpita Soni on 01/01/2015 for ticket #1085 to move Share Report button left side
                    <div class="span6" id="divAddActual">
                        <button id="BtnAddActual" class="btn btn-blue text-shadow-blue source-sans-proregular" type="button">Add Actuals</button>
                    </div>
                }
            
            <div class="span6" id="divShareRep">
                <button class="btn btn-blue text-shadow-blue source-sans-proregular" type="button" id="BtnShareReport">Share Report</button>
            </div>
        </div>
    </div>
@*modified by Rahul Shah for Pl #1837*@
     <!-- Sidebar Block Starts -->
    <div id="Filtersidebar" class="span2 sidebar">
        @*Commented By Maitri Gandhi on 24/2/2016 For #2014*@
        @*<div class="WelcomeMessageBorder"></div>*@

        @*<div class="wraper-btns cf update-result">
            <button class="btn btn-blue text-shadow-blue source-sans-proregular squares-icon update-btn text-center" type="button" id="updatedata" name="updatedata">
                        Update Results
                    </button>
                </div>*@
        <!--success message-->
        <div class="error-msg-filter">
            <div id="successMessageSidebar" class="alert hide alert-success">
                <a class="close">×</a>
                <div id="cSuccess"><span id="spanSuccessMessageRole"></span></div>
            </div>
        </div>
        <!--error message-->
        <div class="sidebar-section scroll-section">
            <div class="float-left filter-preset">
                <div class="width50 float-left filter-title ">
                    <span class="filter-header">Filters</span>
                </div>
                <div class="dropdown" style="float:right;">
                    <button id="dropdownMenu1" class="btn btn-default dropdown-toggle" aria-expanded="true" data-toggle="dropdown" type="button">
                        <i class="fa fa-bars"></i>
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenu1" role="menu">
                        <li onclick="SaveAsPreset()" role="presentation">
                            <a id="saveaslink" tabindex="-1" role="menuitem">Save Current Filters</a> 
                        </li>
                        <li onclick="LoadPreset()" role="presentation">
                            <a tabindex="-1" role="menuitem">Load Saved Filters</a>
                        </li>
                        <li onclick="ClearAllPreset()" role="presentation">
                            <a tabindex="-1" role="menuitem">Clear All</a>
                        </li>
                    </ul>
                </div>

            </div>

            <div style="clear: both;"></div>
            
            @*View Selected Filter Section - #1954 - Added By: Maitri Gandhi *@
            @*Added By Maitri Gandhi on 24/2/2016 For #2014*@
            <div id="accordion-SelectedPlanFilter" class="dropdown-section accordion">
                <div class="accordion-group">
                    <div class="accordion-heading">
                            <h2 id="PlanFilterHeader" class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-SelectedPlanFilter" href="#accordion-element-SelectedPlanFilter">@Enums.FilterLabel.Active_Plans.ToString().Replace("_", " ")<i class="indicator fa fa-angle-up pull-right"></i>@*<i class="indicator glyphicon glyphicon-chevron-up pull-right"></i> tkt#1951 *@</h2>
                    </div>
                        <div id="accordion-element-SelectedPlanFilter" class="accordion-body in collapse">
                            <ul class="scroll-list singleselect" id="ulSelectedPlanFilter">
                                                        @{
                List<string> SelectedYearText = new List<string>();
                List<string> SelectedPlanTitle = new List<string>();
                                }
                            <li class="accordion-inner" title="Year">
                                <span class="sidebarliwidthSelected-left">Year - </span>
                                @{  
                                    foreach (SelectListItem item in ViewYearList)
                                    {
                                        if (item.Selected == true)
                                        {
                                            SelectedYearText.Add(item.Text);
                                        }
                                    }
                                    if (ViewYearList.Count == SelectedYearText.Count())
                                    {
                                        SelectedYearText.Clear();
                                        SelectedYearText.Add("All");
                                    }
                                        }
                                        <span id="lstYearActive" class="sidebarliwidthSelected-right">@string.Join(", ", SelectedYearText).ToString()</span>
                            </li>

                            <li class="accordion-inner" title="Plan">
                                <span class="sidebarliwidthSelected-left">Plan -  </span>
                                @{
                                    foreach (var objplan in planList)
                                    {
                                        if (objplan.Checked == "checked")
                                        {
                                            SelectedPlanTitle.Add(objplan.Title);
                                        }
                                    }
                                    if (planList.Count == SelectedPlanTitle.Count())
                                    {
                                        SelectedPlanTitle.Clear();
                                        SelectedPlanTitle.Add("All");
                                    }

                                        }
                                        <span id="lstPlanActive" class="sidebarliwidthSelected-right">@string.Join(", ", SelectedPlanTitle).ToString()</span>

                            </li>                            
                        </ul>
                    </div>
                    </div>
                </div>

                <div class="padding-content padding-bottom0 sidebar-toogle-wrapper update-btn">
                    <div class="wraper-btns cf">
                        <button class="btn btn-blue text-shadow-blue source-sans-proregular squares-icon" style="min-width: 90%" type="button" id="UpdatePlan" onclick="UpdatePlan()">
                           @Enums.FilterLabel.Update_Plans.ToString().Replace("_"," ")
                        </button>
                </div>
            </div>

            <div id="accordion-Year" class="dropdown-section accordion">
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <h2 id="aYear" class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-Year" href="#accordion-element-Year">Year<i class="indicator fa fa-angle-down pull-right"></i>
                            <span id="tYearcount" class="filter-count">/@ViewYearList.Count</span><span id="cYearcount" class="filter-count"></span></h2>
                    </div>
                    <div id="accordion-element-Year" class="accordion-body collapse">
                        <ul class="scroll-list singleselect" id="ulSelectedYear">
                         @{
                             string ddlYearId,YearText;
                             ddlYearId = YearText = string.Empty;
                             foreach (SelectListItem item in ViewYearList)
                             {
                                 ddlYearId = "liYear" + item.Value;
                                 YearText = item.Text;

                                 if (item.Selected == true)
                                 {
                                     //Modified By Nishant Sheth
                                     // Desc:: #1842 Multiple year selection for multiple year support base on #1821
                                    <li class="accordion-inner close-list" title="@YearText" id="@ddlYearId"  yearValue ="@item.Value"><span class="sidebarliwidth">@YearText</span>
                                        <input type="checkbox" class="chkbxfilter" checked="checked" id="@ddlYearId" onchange="OnYearChange(this);" yearvalue="@item.Value"></input> @*<span class="chkbx-icon"></span>#1951 - sidebar design  checkbox styling*@</li>
                                 }
                                 else
                                 {
                                     <li class="accordion-inner" title="@YearText" id="@ddlYearId"  yearValue ="@item.Value"><span class="sidebarliwidth">@YearText</span>
                                         <input type="checkbox" class="chkbxfilter" id="@ddlYearId" onchange="OnYearChange(this);" yearvalue="@item.Value"></input> @*<span class="chkbx-icon"> </span>#1951 - sidebar design  checkbox styling*@
                                    </li>
                                 }
                             }
                          }
    </ul>
                        <div class="list-tab">
                          @if (ViewYearList == null)
                          {
                          <div id="NoYearFound" class="NoDataFoundFilter">No Year Found</div>
                          }
                        </div>
                    </div>
                </div>
            </div>

            <div id="accordion-2" class="dropdown-section accordion">
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <h2 class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-2" href="#accordion-element-Plan">Plan<i class="indicator fa fa-angle-down pull-right"></i>
                            <span id="tPlancount" class="filter-count"></span> <span id="cPlancount" class="filter-count">/@planList.Count()</span>
                        </h2>
                    </div>
                    <div id="accordion-element-Plan" class="accordion-body collapse">
                        <ul class="scroll-list" id="ulSelectedPlans">
                         @{
                             string ddlId = string.Empty;
                             string dimensionId = string.Empty;
                             var PlanDimensionId = ListDimension.Where(a => a.Name == Enums.Dimension.PlanId.ToString()).Select(a => a.id).FirstOrDefault();
                             var ListPlanDimensionValue = ListDimensionVaule.Where(a => a.DimensionID == PlanDimensionId).ToList();
                             foreach (var item in planList)
                             {
                                 ddlId = "liPlan" + "_" + item.PlanId;
                                 dimensionId = string.Empty;
                                 if (PlanDimensionId != null && PlanDimensionId > 0 && ListPlanDimensionValue != null && ListDimensionVaule.Count > 0)
                                 {
                                     var PlanDimensionValue = ListPlanDimensionValue.Where(a=>a.Value==item.PlanId.ToString()).Select(a=>a.id).FirstOrDefault();
                                     if(!string.IsNullOrEmpty(Convert.ToString(PlanDimensionValue)))
                                     { 
                                        dimensionId = PlanDimensionId.ToString() + "_" + PlanDimensionValue.ToString();
                                     }
                                 }
                                 if (item.Checked == "checked")
                                 {
                                     <li class="accordion-inner close-list" title="@item.Title" id="@ddlId" dimensionid="@dimensionId"><span class="sidebarliwidth">@item.Title</span><input type="checkbox" class="chkbxfilter" checked="checked" id="@item.PlanId" dimensionid="@dimensionId" onchange="OnPlanchange(this);" ></input> @*<span class="chkbx-icon"></span> #1951 - sidebar design  checkbox styling*@</li>
                                 }
                                 else
                                 {
                                    <li class="accordion-inner" title="@item.Title" id="@ddlId" dimensionid="@dimensionId"><span class="sidebarliwidth">@item.Title</span><input type="checkbox" class="chkbxfilter" id="@item.PlanId" dimensionid="@dimensionId" onchange="OnPlanchange(this);"></input> @*<span class="chkbx-icon"></span> #1951 - sidebar design  checkbox styling*@</li>
                                 }

                             }
                          }
                        </ul>
                        <div class="list-tab">
                           @if (planList != null)
                           {
                            <ul id="PlanAllModule">
                                <li><a onclick="BulkPlanOperation(true)">select all</a></li>
                                <li>|</li>
                                <li><a onclick="BulkPlanOperation(false)">@*deselect all*@clear</a></li>
                            </ul>
                               <div id="NoPlanFound" class="NoDataFoundFilter" style="display:none;">No Plan Found</div>
                           }
                           else
                           {
                            <div id="NoPlanFound" class="NoDataFoundFilter">No Plan Found</div>
                           }
                        </div>
                    </div>
                </div>
            </div>
             
             <div id="accordion-SelectedFilter" class="dropdown-section accordion">
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <h2 id="aYear" class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-SelectedFilter" href="#accordion-element-SelectedFilter">@Enums.FilterLabel.Active_Attributes.ToString().Replace("_"," ")<i class="indicator fa fa-angle-up pull-right"></i></h2>
                    </div>
                    <div id="accordion-element-SelectedFilter" class="accordion-body in collapse">
                        <ul class="scroll-list singleselect" id="ulSelectedFilter">
                                                        @{
                                                            List<string> OwnerName = new List<string>();
                                                            List<string> StatusTitle = new List<string>();
                                }                                                          
                            @{
                                foreach (var custField in ViewCustomFields)
                                {
                                <li class="accordion-inner" title='@custField.Name'>
                                    <div id="CustomFields">
                                    <span class="sidebarliwidthSelected-left">@custField.Name - </span>
                                    <span id="lstCustomFieldSelected_@custField.CustomFieldId" class="sidebarliwidthSelected-right">All</span>
                                    </div>
                            </li>
                                }
                            }

                            <li class="accordion-inner" title="Owner">
                                <span class="sidebarliwidthSelected-left">Owner - </span>
                                <span id="lstOwner" class="sidebarliwidthSelected-right"></span>

                            </li>

                            <li class="accordion-inner" title="TacticType">
                                <span class="sidebarliwidthSelected-left">Tactic Type - </span>
                                <span id="lstTType" class="sidebarliwidthSelected-right"></span>
                            </li>                            
                        </ul>
                    </div>
                </div>
            </div>

            

           @* <div id="accordion-quart" class="dropdown-section accordion">
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <h2 id="aTimeFrame" class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-quart" href="#accordion-element-quart"><span class="sidebarliwidth" id="spTimeFrameText">Monthly</span><i class="indicator glyphicon glyphicon-chevron-down pull-right"></i></h2>
                    </div>
                    <div id="accordion-element-quart" class="accordion-body collapse">
                        <ul class="scroll-list singleselect" id="ulSelectedQuart">
                            <li class="accordion-inner close-list" title="Monthly" id="liMonthly" timeframe-val="@_monthly" onclick="OnTimeFrameChange(this);"><span class="sidebarliwidth">@_monthly</span></li>
                            <li class="accordion-inner" title="Quarterly" id="liQuarterly" timeframe-val="@_quarterly" onclick="OnTimeFrameChange(this);"><span class="sidebarliwidth">@_quarterly</span></li>
                        </ul>
                        <div class="list-tab">
                        </div>
                    </div>
                </div>
            </div>*@

            
             <div class="padding-content padding-bottom0 sidebar-toogle-wrapper update-btn">
                <div class="wraper-btns cf">
                    <button class="btn btn-blue text-shadow-blue source-sans-proregular squares-icon" style="min-width: 90%" type="button" id="ApplyFilters" onclick="ApplyFilters()">
                      @Enums.FilterLabel.Update_Attributes.ToString().Replace("_"," ")
                    </button>
                </div>
            </div>

           <div id="divCustomFieldsFilter">
            @{
                string acordionId, acordionParentId, acordionElementId, acordionElementHref, liCustom, ulCustom, allCustom, noCustom, cutomoptioninputid;
                acordionId = acordionParentId = acordionElementId = acordionElementHref =liCustom =ulCustom = allCustom = noCustom =string.Empty;
                List<SelectListItem> lstCutomFieldOptions = new List<SelectListItem>();
                List<CustomFieldOption> tblCustomFieldOption = ViewCustomFieldOptions;
                List<DimensionValue> lstCustomFieldDimensionValue = new List<DimensionValue>();
                
                int custFieldCount = 0;
                foreach (CustomField custField in ViewCustomFields)
                {
                    lstCutomFieldOptions = tblCustomFieldOption.Where(_option => custField.CustomFieldId == _option.CustomFieldId).OrderBy(custfieldoptions => custfieldoptions.Value).ToList().Select(custfieldoptions => new SelectListItem { Text = custfieldoptions.Value, Value = custfieldoptions.CustomFieldOptionId.ToString(), Selected = true }).ToList();
                    var CustomDimension = Convert.ToString(custField.Name + "_" + custField.CustomFieldId);
                    var CustomDimensionId = ListDimension.Where(a => a.Name == CustomDimension).Select(a => a.id).FirstOrDefault();
                    var ListCustomDimensionValues = ListDimensionVaule.Where(a => a.DimensionID == CustomDimensionId).ToList();
                    acordionId = "accordion" + custField.CustomFieldId;
                    acordionParentId = "#" + acordionId;
                    acordionElementId = "accordion-element-Plan" + custField.CustomFieldId;
                    acordionElementHref = "#" + acordionElementId;
                    ulCustom = "ul" + custField.CustomFieldId;
                    allCustom = "all" + custField.CustomFieldId;
                    noCustom = "no" + custField.CustomFieldId;
                    <div id="@acordionId" class="dropdown-section accordion">
                        <div class="accordion-group">
                           <div class="accordion-heading">
                               <h2 class="accordion-toggle" data-toggle="collapse" data-parent="@acordionParentId" href="@acordionElementHref"><span class="sidebar_label tipsyclassTitle">@custField.Name</span><i class="indicator fa fa-angle-down pull-right"></i><span class="filter-count"><span id="SelectedCustomFilter_@custField.CustomFieldId">@lstCutomFieldOptions.Count()</span>/@lstCutomFieldOptions.Count()</span></h2>
                           </div>
                           <div id="@acordionElementId" class="accordion-body collapse">
                               <ul class="scroll-list" id="@ulCustom">
                                @{
                    foreach (SelectListItem item in (System.Collections.IEnumerable)lstCutomFieldOptions)
                    {
                        liCustom = "liCustom" + item.Value;
                        cutomoptioninputid = custField.CustomFieldId + "_" + item.Value;
                        dimensionId = string.Empty;
                        if (CustomDimensionId != null && CustomDimensionId > 0 && ListCustomDimensionValues != null && ListCustomDimensionValues.Count > 0)
                        {
                            var CustomDimensionValue = ListCustomDimensionValues.Where(a => a.Value == item.Value.ToString()).Select(a => a.id).FirstOrDefault();
                            if (!string.IsNullOrEmpty(Convert.ToString(CustomDimensionValue)))
                            {
                                dimensionId = CustomDimensionId.ToString() + "_" + CustomDimensionValue.ToString();
                            }
                        }
                        <li class="accordion-inner" title="@item.Text" id="@liCustom" dimensionid="@dimensionId">
                            <span class="sidebarliwidth">@item.Text</span>
                            <input type="checkbox" cutomtitle="@item.Text" class="chkbxfilter" dimensionid="@dimensionId" id="@cutomoptioninputid" onchange="OnMultiselectchange(this,@custField.CustomFieldId,@custFieldCount);"></input> @*<span class="chkbx-icon"></span>#1951 - sidebar design  checkbox styling*@
                        </li>
                    }
                                }
                               </ul>
                               <div class="list-tab">
                                  @if (lstCutomFieldOptions != null && lstCutomFieldOptions.Count > 0)
                                  {
                                   <ul id="@allCustom">
                                       <li><a onclick="BulkCustomFieldOperation(true,'@ulCustom','@lstCutomFieldOptions.Count()')">select all</a></li>
                                       <li>|</li>
                                       <li><a onclick="BulkCustomFieldOperation(false,'@ulCustom','@lstCutomFieldOptions.Count()')">@*deselect all*@clear</a></li>
                                   </ul>
                                  }
                                  else
                                  {
                                   <div id="@noCustom" class="NoDataFoundFilter">No Plan Found</div>
                                  }
                               </div>
                           </div>
                       </div>
                   </div>
                                  custFieldCount++;
                }
             }
        </div>
           @* Added By komal Rawal*@
            <div id="accordion-Owner" class="dropdown-section accordion" > 
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <h2 class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-Owner" href="#accordion-element-Owner">Owner<i class="indicator fa fa-angle-down pull-right"></i><span id="tOwnercount" class="filter-count"></span><span id="cOwnercount" class="filter-count"></span></h2>
        </div>
                    <div id="accordion-element-Owner" class="accordion-body collapse">
                        <ul class="scroll-list" id="ulSelectedOwner">
                        </ul>
                        <div class="list-tab">
                            <ul id="ulOwnerAllModule">
                                <li><a onclick="BulkOwnerOperation(true)">select all</a></li>
                                <li>|</li>
                                <li><a onclick="BulkOwnerOperation(false)">@*deselect all*@clear</a></li>
                            </ul>
                            <div id="NoOwnerFound" class="NoDataFoundFilter">No Owner Found</div>
    </div>
                    </div>
                </div>
            </div>

              <div id="accordion-TacticType" class="dropdown-section accordion" >
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <h2 class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-TacticType" href="#accordion-element-TacticType">Tactic Type<i class="indicator fa fa-angle-down pull-right"></i><span id="tTTcount" class="filter-count"></span><span id="cTTcount" class="filter-count"></span></h2>
                    </div>
                    <div id="accordion-element-TacticType" class="accordion-body collapse">
                        <ul class="scroll-list" id="ulTacticType">
                            
                        </ul>
                        <div class="list-tab">
                              <ul id="TacticTypeAllModule">
                                    <li><a onclick="BulkTTOperation(true)">select all</a></li>
                                    <li>|</li>
                                    <li><a onclick="BulkTTOperation(false)">@*deselect all*@clear</a></li>
                                </ul>
                                <div id="NoTTFound" class="NoDataFoundFilter">No Tactic Type Found</div>
                             
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    
   
    <!--End sidebar-->
}

<div class="report-heder-tab">
   <ul id="ulLeftPane">
       <li class="active" id="liSummary"><a class="overview"><span class="rMenu-icon"></span>OVERVIEW</a></li>
       <li id="liRevenue"><a class="revenue" ><span class="rMenu-icon"></span>REVENUE</a></li>
       @*<li id="liConversion"><a class="conversion" ><span></span>CONVERSION</a></li>*@
       <li id="liConversion"><a class="conversion" ><span class="rMenu-icon"></span>WATERFALL</a></li> @*--title changed by dashrath prajapati*@
       <li id="liBudgetreport"><a class="budget" ><span class="rMenu-icon"></span>FINANCE</a></li> @*PL#1545 Dashrath Prajapati*@
       @if (DashboardList.Count > 0)
       {
       <li id="liCustomReport" class="dropdown">
           <a class="custom dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-target="#"><span class="fa fa-bar-chart rMenu-iconFa" aria-hidden="true"></span>Custom</a>
           <ul class="dropdown-menu">
               @foreach (var Dashboard in DashboardList)
               {
                   string liid = "CustomReportli" + Dashboard.Id;
                   string CustomCSS = "fa fa-caret-right";
                   if (!string.IsNullOrEmpty(Dashboard.CustomCSS))
                   {
                       CustomCSS = Dashboard.CustomCSS; 
                   }
                <li id='@liid'>
                    <a class="budget">
                        <span class="@CustomCSS"></span>@Dashboard.DisplayName.ToUpper()
</a>
                </li>
               
               }
           </ul>

       </li> 
       }  
   </ul>
</div>

@*Added By komal Rawal for #1296*@
<div style="height:40px" id="ddlsection" class="ddlQuarter">
     <div style="float: right;margin-top:20px; margin-right:15px;">
      <span class="selectBox" id="ddlAllocatedBySelectBox" style="width: 158px;line-height:1.1;">
                    @Html.DropDownList("ddlAllocate", new SelectList((System.Collections.IEnumerable)ViewBag.ViewByAllocated, "Value", "Text", @RevenuePlanner.Helpers.Enums.PlanAllocatedBy.quarters.ToString()), new { @class = "ddlStyleReport hide" })
               </span>
     </div>
</div>
<div style="height:40px;display:none;" id="ddlCustomTimeFrame" class="ddlQuarter">
    <div style="" class="breadcrum-wrap">
        
        <ol class="breadcrumb">
            <li><span>Custom</a></span></li>
            <li class="active" id="dashboardpagetext"></li>
        </ol>
    </div>
    
    <div style="float: right;margin-right:15px;">
        <span class="selectBox" id="ddlCustomAllocatedBySelectBox" style="width: 158px;line-height:1.1;">
            @Html.DropDownList("ddlCustomAllocate", new SelectList((System.Collections.IEnumerable)ViewBag.ViewByAllocated, "Value", "Text", @RevenuePlanner.Helpers.Enums.PlanAllocatedBy.quarters.ToString()), new { @class = "ddlStyleReport hide" })
        </span>
    </div>
    <div class="timecolbox">
        <div>
            @Html.Raw(@Html.GetLastLogDate())
            @*<p class="timecol">as of 05/20/2015</p>
            <p class="timecol">2:25PM IST</p>*@
        </div>
    </div>
</div>

<div id="budgetHeader" class="budgetColums budgetReporting" style="display: none">
    <div class="plannedCost">
        <h3 class="source-sans-proregular h3budget h3padding ">You've spent <span id="SpanTotalSpend"></span> out of <span id="SpanTotalBudgeted"></span>.</h3>
        <div style="clear: both;"></div>
    </div>
    <div class="budgetCompare monthContainerBudget">
        <h3 class="source-sans-proregular" id="monthCompareTitle"></h3>
        <div class="budgetCompareInner" id="monthContainer">
    </div>
        <div style="clear: both;"></div>
    </div>
</div>

<div id="revenueHeader" class="budgetColums budgetReporting" style="display: none">
    <div class="plannedCost">
        <h3><span>Marketing Revenue</span>
            <br />
        </h3>
        <div style="clear: both;"></div>
    </div>
    <div class="budgetCompare">
        <div id="RevenueActualDiv" class="header-right-blocks">
        <p class="source-sans-probold">Actual</p>
            <p class="value source-sans-prolight" style="font-size: 30px;" id="revenueActual"></p>
        <h5 id="revenueActualPercentage"></h5>
    </div>
        <div id="RevenueProjectedDiv" class="header-right-blocks block-last">
        <p class="source-sans-probold">Goal</p>
            <p class="value source-sans-prolight" id="revenueProjected" style="font-size: 30px;"></p>
        <p class="ellipsis-block FormatingBlock">Revenue</p>

    </div>
    </div>
</div>

<div id="conversionHeader" class="budgetColums budgetReporting" style="display: none">
    <div class="plannedCost">
        <h3><span>Waterfall Conversion</span>
            <br />
        </h3>
        <div style="clear: both;"></div>
    </div>
    <div class="budgetCompare">
        <div  id="mqlActualDiv" class="header-right-blocks">
            <p class="source-sans-probold">Actual</p>
            <p class="value source-sans-prolight" id="mqlActual" style="font-size: 30px;"></p>
            <h5 id="mqlActualPercentage"></h5>
        </div>
        <div id="mqlProjectedDiv" class="header-right-blocks block-last"> 
            <p class="source-sans-probold">Goal</p>
            <p class="value source-sans-prolight" id="mqlProjected" style="font-size: 30px;"></p>
            <p class="ellipsis-block FormatingBlock">@Html.LabelForMQL("MQL")</p>

        </div>
    </div>
</div>

<div id="divMainReportPart" class="margin_top20">
</div>
<div id="DivShareReport">
</div>
<script type="text/javascript">
    var IsCardDetailsClick = false; // for #1489
    //Added By komal Rawal

    //Added for #1296
    $("#ddlAllocatedBySelectBox select").selectbox();
    // Add By Nishant Sheth
    // Desc :: Display chart with quartely/monthly
    $("#ddlCustomAllocatedBySelectBox select").selectbox();
    $("#ddlCustomAllocate").change(function () {
        LoadAllReports();
    });
    $("#ddlAllocate").change(function () {

        AllocatedBy = $('#ddlAllocate option:selected').text();

        Qurt_Month = AllocatedBy;
        if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Summary.ToString()') {
            LoadSummary();
        }
        else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Revenue.ToString()') {
            LoadRevenueData();
        }
        else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Conversion.ToString()') {
            LoadConversionData();
        }
        else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
            LoadBudgetView();
        }
    });


    //End


    var filters = {
        OwnerIds: [],
        TacticTypeids: [],
        customFieldIds: [],
        PlanIDs: [],
        SelectedPlans: [],
        StatusIDs: [],
        SelectedYears: [],
        parentCustomFieldsIds: [],
        SelectedYears: []
    };
    //Added By Maitri Gandhi for #1954 on 18/2/2016
    var FiltersAll = "All";
    var FiltersNone = "None";

    var selectedFilters = {
        yearIds: [],
        planName: [],
        ownerName: [],
        tacticTypeTitle: [],
        StatusIds: []
    };
    var TotalStatus = 0;
    var checkedOwnercount = 0;
    var checkedTTcount = 0;
    //var checkedStatuscount = 0;
    var checkedPlancount = 0;
    var checkedYearcount = 0;
    var AutoSelectedCustomField = 0;
    checkedYearcount = $('#ulSelectedYear li input:checked').length;
    $('#cYearcount').text(checkedYearcount);

    var ids = [];
    var IsDeselectAll = false;
    var currentRequest = null;//Added By Komal Rawal for #1992 to abort previous ajax if any request is called before completion of previou request.
    var OwnerDimensionList = JSON.parse('@Html.Raw(Json.Encode(OwnerDimensionList))');
    var TacticTypeDimensionList = JSON.parse('@Html.Raw(Json.Encode(TacticTypeDimensionList))');
    function GetOwnerListForFilter(Planids, ifexists, OnPlanChange) {
        var type = '@PlanGanttTypes.Tactic.ToString()';
        var asyncval = false;
        if (ifexists != undefined && ifexists != 'undefined' && ifexists != '' && ifexists != null) {
            asyncval = ifexists;
        }
        //Commented By Maitri Gandhi on 24/2/2016 For #2014
        //var SelectedPlanCount = 0;
        //$('#ulSelectedPlans').find("input[type=checkbox]").each(function () {
        //    if ($(this).attr('checked') == 'checked') {
        //        SelectedPlanCount++;

        //    }
        //});


        //if (SelectedPlanCount == 0) {
        //    IsDeselectAll = true;
        //}
        //else if (SelectedPlanCount > 1 && filters.OwnerIds != "") {
        //    IsDeselectAll = false;
        //}


        ////Added by Rahul Shah on 06/01/2016 for PL #1854

        //if (IsDeselectAll == true )
        //{
        //    ids = [];
        //}

        //$('#ulSelectedOwner li').each(function () {
        //    if ($(this).hasClass("close-list")) {
        //        var id = $(this).attr('id').replace('liOwner', '')
        //        var Index = ids.indexOf(id);
        //        if (Index == -1)
        //        {
        //        ids.push(id);
        //    }

        //    }
        //});
        //if (filters.OwnerIds != "" || OnPlanChange != true || ids != "") {

        //    filters.OwnerIds = [];
        //}
        $('#ulSelectedOwner').html('');
        filters.OwnerIds = [];


        currentRequest = $.ajax({
            beforeSend: function (x) {
                myApp.hidePleaseWait();
                //Added By Komal Rawal for #1992 to abort previous ajax if any request is called before completion of previou request.
                if (currentRequest != null) {
                    currentRequest.abort();
                }
            },
            type: "GET",
            cache: false,
            async: asyncval,
            @* url: '@Url.Action("GetOwnerListForFilter", "Report")',*@
            url: '@Url.Action("GetOwnerListForFilter", "Home")',
            data: {
                PlanId: Planids.toString(),
                ViewBy: type,
                ActiveMenu: '@RevenuePlanner.Helpers.Enums.ActiveMenu.Home'

            },
            dataType: "json",
            success: function (data) {

                if (data.returnURL != 'undefined' && data.returnURL == '#') {
                    window.location = '@Url.Content(Common.RedirectOnServiceUnavailibilityPage)';
                }
                else {
                    if (data.isSuccess == true) {
                        var LoggedInOwner = data.LoggedInUser.OwnerId;
                        if (data.AllowedOwner != 'undefined' && data.AllowedOwner != null) {
                            OwnerCount = data.AllowedOwner.length;
                            if (OwnerCount > 0) {
                                var IsOwnerPresent = false;
                                var checked = "";
                                var checkedclass = "";
                                $("#ulOwnerAllModule").css("display", "block");
                                $("#NoOwnerFound").hide();
                                $('#ulSelectedOwner li').remove();
                                $.each(data.AllowedOwner, function (i, OwnerItem) {
                                    var checked = "";
                                    var checkedclass = "";
                                    var DimensionOwnerId = "";
                                    
                                    $.each(OwnerDimensionList, function () {
                                        var OwnerValue = this;
                                        if (OwnerValue.Value == OwnerItem.OwnerId.toUpperCase())
                                        {
                                            DimensionOwnerId = '@OwnerDimensionId' + '_' + OwnerValue.Id;
                                        }
                                    });
        

                                    if (OwnerItem.OwnerId == LoggedInOwner) {
                                        IsOwnerPresent = true;
                                        //if (filters.OwnerIds != "" || OnPlanChange != true || ids.indexOf(OwnerItem.OwnerId) >= 0) {
                                        //checked = "checked"
                                        //checkedclass = "close-list"
                                        //}
                                    }
                                    //Added by Rahul Shah on 06/01/2016 for PL #1854

                                    //if (ids.indexOf(OwnerItem.OwnerId) >= 0) {
                                    checked = "checked"
                                    checkedclass = "close-list"
                                    //}

                                    //var checked = "";
                                    //var checkedclass = "";
                                    //Modify by Rahul Shah on 28/10/2015 for PL #1438
                                    //if (ifexists &&  filters.OwnerIds.indexOf(OwnerItem.OwnerId)>= 0) {
                                    // checked = "checked";
                                    // checkedclass = "close-list";
                                    //}

                                    $('#ulSelectedOwner').append('<li class="accordion-inner ' + checkedclass + '" title="' + OwnerItem.Title + '" id="liOwner' + OwnerItem.OwnerId + ' dimensionid="' + DimensionOwnerId + '""><span class="sidebarliwidth">' + OwnerItem.Title + '</span><input type="checkbox" class="chkbxfilter" OwnerTitle="' + OwnerItem.Title + '" onchange="toggleOwner(this)" dimensionid="' + DimensionOwnerId + '" id="' + OwnerItem.OwnerId + '"' + checked + ' ></input></li>'); /*<span class="chkbx-icon"></span>*/




                                });


                                if (IsOwnerPresent == false) {

                                    // Modified By Nishant Sheth
                                    // Desc:: To resolve the #1790 observation
                                    //if (filters.OwnerIds != "" || OnPlanChange != true || ids.indexOf(LoggedInOwner) >= 0) {
                                    checked = "checked"
                                    checkedclass = "close-list"
                                    //}
                                    $('#ulSelectedOwner').append('<li class="accordion-inner ' + checkedclass + '" title="' + data.LoggedInUser.Title + '" id="liOwner' + data.LoggedInUser.OwnerId + ' dimensionid=' + DimensionOwnerId + '"><span class="sidebarliwidth">' + data.LoggedInUser.Title + '</span><input type="checkbox" class="chkbxfilter" OwnerTitle="' + data.LoggedInUser.Title + '" dimensionid=' + DimensionOwnerId + ' onchange="toggleOwner(this)" id="' + data.LoggedInUser.OwnerId + '"' + checked + '></input></li>');
                                }
                                //Commented By Maitri Gandhi on 24/2/2016 For #2014
                                //Added By Komal Rawal for #1984 to resolve issue of owner deselection on plan change.
                                //var OwnerIds = [];
                                //$('#ulSelectedOwner li').each(function () {
                                //    var id = $(this).attr('id').replace('liOwner', '')
                                //    OwnerIds.push(id);
                                //});
                                //var listofindex = [];
                                //for (i = 0; i < ids.length; i++) {
                                //    var index = OwnerIds.indexOf(ids[i]);
                                //    if (!(index >= 0)) {
                                //        listofindex.push(ids[i]);

                                //    }
                                //}
                                //$.each(listofindex, function (i) {
                                //    var Index = ids.indexOf(listofindex[i])
                                //    if (Index >= 0) {
                                //        ids.splice(Index, 1);
                                //    }
                                //});
                                //End
                            }
                            else {
                                $("#ulOwnerAllModule").css("display", "none");
                                $("#NoOwnerFound").show();
                            }
                        }
                        else {
                            $("#ulOwnerAllModule").css("display", "none");
                            $("#NoOwnerFound").show();
                        }
                        checkedOwnercount = $("#ulSelectedOwner li input:checkbox:checked").length;
                        TotalOwnercount = $("#ulSelectedOwner li").length;
                        $('#tOwnercount').text('/' + TotalOwnercount);
                        $('#cOwnercount').text(checkedOwnercount);
                    }
                }
                currentRequest = null;//Added By Komal Rawal for #1992 to abort previous ajax if any request is called before completion of previou request.
            }
        });
    }


    function BulkOwnerOperation(selection) {
        filters.OwnerIds = [];
        if (selection) {
            $("#ulSelectedOwner li").each(function (i) {
                $(this).addClass("close-list");
                var chkid = $(this).find("input[type=checkbox]").attr("id");
                $("#" + chkid).attr("checked", "checked");
                filters.OwnerIds.push(chkid);
            });
        }
        else {
            IsDeselectAll = true;
            $("#ulSelectedOwner li").each(function (i) {
                $(this).removeClass("close-list");
                var chkid = $(this).find("input[type=checkbox]").attr("id");
                $("#" + chkid).removeAttr("checked");
            });
        }
        checkedOwnercount = $("#ulSelectedOwner li input:checkbox:checked").length;
        $('#cOwnercount').text(checkedOwnercount);
    }


    function toggleOwner(obj) {
        var id = $(obj).attr('id');
        if ($(obj).is(':checked')) {
            $("#liOwner" + id).addClass("close-list");
        }
        else {
            $("#liOwner" + id).removeClass("close-list");
            //var Index = ids.indexOf(id)
            //if (Index >= 0) {
            //    ids.splice(Index, 1);
            //}
        }
        filters.OwnerIds = [];
        $("#ulSelectedOwner li input[type=checkbox]").each(function () {
            var chkid = $(this).attr("id");
            if ($(this).is(':checked')) {
                filters.OwnerIds.push(chkid);
            }
        });
        checkedOwnercount = $("#ulSelectedOwner li input:checkbox:checked").length;
        $('#cOwnercount').text(checkedOwnercount);
    }

    var currentRequestforTactics = null;//Added By Komal Rawal for #1992 to abort previous ajax if any request is called before completion of previou request.
    function GetTacticTypelist(Planids, ifexists) {
        var asyncval = false;
        if (ifexists != undefined && ifexists != 'undefined' && ifexists != '' && ifexists != null) {
            asyncval = ifexists;
        }
        else {
            asyncval = false;
        }
        //Commented By Maitri Gandhi on 24/2/2016 For #2014
        //var tacids = [];
        //$('#ulTacticType li').each(function () {
        //    if ($(this).hasClass("close-list") == false) {
        //        var id = $(this).attr('id').replace('liTT', '')
        //        var Index = tacids.indexOf(id);
        //        if (Index == -1) {
        //            tacids.push(id);
        //        }
        //    }
        //});

        $('#ulTacticType').html('');
        if (!ifexists) {
            filters.TacticTypeids = [];
        }
        currentRequestforTactics = $.ajax({
            beforeSend: function (x) {
                myApp.hidePleaseWait();
                //Added By Komal Rawal for #1992 to abort previous ajax if any request is called before completion of previou request.
                if (currentRequestforTactics != null) {
                    currentRequestforTactics.abort();
                }
            },
            type: "GET",
            cache: false,
            async: asyncval,
            @* url: '@Url.Action("GetTacticTypeListForFilter", "Report")',*@
            url: '@Url.Action("GetTacticTypeListForFilter", "Home")',
            data: {
                PlanId: Planids.toString()
            },
            dataType: "json",
            success: function (data) {
                if (data.returnURL != 'undefined' && data.returnURL == '#') {
                    window.location = '@Url.Content(Common.RedirectOnServiceUnavailibilityPage)';
                }
                else {
                    if (data.isSuccess == true) {
                        if (data.TacticTypelist != 'undefined' && data.TacticTypelist != null) {
                            TactictypeCount = data.TacticTypelist.length;
                            if (TactictypeCount > 0) {
                                $("#TacticTypeAllModule").css("display", "block");
                                $("#NoTTFound").hide();
                                $.each(data.TacticTypelist, function (i, TactictypeItem) {
                                    var checked = "";
                                    var checkedclass = "";

                                    var TacticTypeDimensionId = "";
                                    $.each(TacticTypeDimensionList, function () {
                                        var TacticTypeValue = this;
                                        if (TacticTypeValue.Value == TactictypeItem.TacticTypeId.toString()) {
                                            TacticTypeDimensionId = '@TacticTypeDimensionId' + '_' + TacticTypeValue.Id;
                                        }
                                    });
                                    
                                    //Modify by Rahul Shah on 28/10/2015 for PL #1438
                                    checked = "checked"
                                    checkedclass = "close-list"
                                    ////Added by Maitri Gandhi for #1954
                                    //if (Array.isArray(tacids) && tacids.length > 0) {
                                    //    if (tacids.indexOf(TactictypeItem.TacticTypeId.toString()) >= 0) {
                                    //        checked = ""
                                    //        checkedclass = ""
                                    //    }
                                    //}
                                    //}
                                    $('#ulTacticType').append('<li class="accordion-inner ' + checkedclass + '" title="' + TactictypeItem.Title + '" id="liTT' + TactictypeItem.TacticTypeId + ' dimensionid="' + TacticTypeDimensionId + '""><span class="sidebarliwidth">' + TactictypeItem.Title + '</span><input type="checkbox" class="chkbxfilter" dimensionid="' + TacticTypeDimensionId + '" TacticTypeTitle="' + TactictypeItem.Title + '" onchange="toggleTacticType(this)" id="CbTT' + TactictypeItem.TacticTypeId + '"' + checked + '></input></li>');/*<span class="chkbx-icon"></span>*/
                                });
                            }
                            else {
                                $("#TacticTypeAllModule").css("display", "none");
                                $("#NoTTFound").show();
                            }
                        }
                        else {
                            $("#TacticTypeAllModule").css("display", "none");
                            $("#NoTTFound").show();
                        }
                        TactictypeCount = $("#ulTacticType li").length;
                        checkedTTcount = $("#ulTacticType li input:checkbox:checked").length;
                        $('#tTTcount').text('/' + TactictypeCount);
                        $('#cTTcount').text(checkedTTcount);
                    }
                }

                currentRequestforTactics = null;//Added By Komal Rawal for #1992 to abort previous ajax if any request is called before completion of previou request.
            }
        });

    }
    // var TacticDeselectAll = false;
    function BulkTTOperation(selection) {
        filters.TacticTypeids = [];
        if (selection) {
            $("#ulTacticType li").each(function (i) {
                $(this).addClass("close-list");
                var chkid = $(this).find("input[type=checkbox]").attr("id");
                $("#" + chkid).attr("checked", "checked");
                filters.TacticTypeids.push(chkid.replace("CbTT", ""));

            });
        }
        else {
            //  TacticDeselectAll = true;
            $("#ulTacticType li").each(function (i) {
                $(this).removeClass("close-list");
                var chkid = $(this).find("input[type=checkbox]").attr("id");
                $("#" + chkid).removeAttr("checked");
            });
            //checkedTTcount = 0;
        }
        checkedTTcount = $("#ulTacticType li input:checkbox:checked").length;
        $('#cTTcount').text(checkedTTcount);
    }

    var SelectedCustomFieldOption;
    function toggleTacticType(obj) {
        var id = $(obj).attr('id').toString().replace("CbTT", "");
        if ($(obj).is(':checked')) {
            $("#liTT" + id).addClass("close-list");
        }
        else {
            $("#liTT" + id).removeClass("close-list");
        }

        filters.TacticTypeids = [];
        $("#ulTacticType li input[type=checkbox]").each(function () {
            var chkid = $(this).attr("id");
            if ($(this).is(':checked')) {
                filters.TacticTypeids.push(chkid.replace("CbTT", ""));
            }
        });
        checkedTTcount = $("#ulTacticType li input:checkbox:checked").length;
        $('#cTTcount').text(checkedTTcount);
    }

    //End
    var SelectedBUId, SelectedPlanId;
    var IsCallFromYearDropdown = true;
    var OptionMain = '';
    var years = ""; // Add By Nishant Sheth
    var isAllowClick = true;
    var multiselectPlanId = "ulSelectedPlans";
    var leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Summary.ToString()';
    var Qurt_Month = '@Enums.ViewByAllocated.Quarterly.ToString()';

    $(document).ready(function () {
        myApp.showPleaseWait();// add by nishant sheth
        $('#ddlCustomTimeFrame').hide(); //Add By Nishant Sheth #2262
        $("#ddlYearSpan select").selectbox();
        $('.sbHolder').click(function () {
            $(".budgetReportFilter-area").find(".multiselection-select").each(function () {
                $(this).multiselect("close");//"Close" is function in multiselect.js which close the multiselect menu
            });
        });
        ///Start Modified by Mitesh Vaishnav for PL ticket #727
        $(".budgetReportFilter-area").find(".multiselection-select").each(function () {
            $(this).multiselect({ noneSelectedText: $(this).attr('noneselectedvalue') }).multiselectfilter();
        });

        $(".sbSelector").css("color", "#6D6D6D");
        $(".sbToggle").css("border-top-color", "#6D6D6D");

        OptionMain = getYearSelectedValue(true);

        // Qurt_Month = getQuarterMonthlySelectedValue();

        // Load Multiselect Dropdown list i.e. Bind with new design
        LoadYearDropdown();
        //loadBasedOnPlan(); // Commented By Nishant Sheth due to off multiple time same methods are called
        PlanIds = GetFilterIdForPlan(multiselectPlanId);
        GetTacticTypelist(PlanIds, false);
        GetOwnerListForFilter(PlanIds, false);
        GetLastSetofViews($('#FilterName').val());
        GetselectionFilter();
        $("#DivShareReport").hide();
        GetFilterIdForPlan(multiselectPlanId);
        function toggleChevron(e) {
            $(e.target)
				.prev('.accordion-heading')
				.find("i.indicator")
            //.toggleClass('glyphicon-chevron-down glyphicon-chevron-up'); /* #1952 */
            .toggleClass('fa-angle-down fa-angle-up');
        }
        $('.accordion').on('hidden.bs.collapse', toggleChevron);
        $('.accordion').on('shown.bs.collapse', toggleChevron);
        NumberFormatterTipsyTitle(".tipsyclassTitle", 27);

        $('#ulLeftPane .dropdown-toggle').dropdown(); // Added for #2257 
    });

    function GetLastSetofViews(presetName) {
        $.ajax({
            type: 'POST',
            url: '@Url.Action("LastSetOfViews", "Home")',
            data: { PresetName: presetName },
            dataType: "json",
            async: false,
            success: function (data) {
                if (data.returnURL != 'undefined' && data.returnURL == '#') {
                    window.location = '@Url.Content("~/Login/Index")';
                }
                else {
                    AutoSelectedCustomField = 0;
                    if (data.Customfields.length != 0 && data.Customfields.length != undefined) {
                        for (i = 0 ; i < data.Customfields.length; i++) {
                            if (data.Customfields[i].ID.split('_').length > 1) {
                                var CustomFieldId = data.Customfields[i].ID.split('_')[1];
                                var CustomFieldValues = data.Customfields[i].Value;
                                $('#divCustomFieldsFilter').find("input[type=checkbox]").each(function () {
                                    var chkid = $(this).attr("id");
                                    var chkfieldid = $(this).attr("id").split('_')[0];
                                    var chkOptionid = $(this).attr("id").split('_')[1];
                                    if (chkfieldid == CustomFieldId) {
                                        if (CustomFieldValues.indexOf(chkOptionid) != -1) {
                                            $(this).attr('checked', 'checked');
                                            AutoSelectedCustomField++;
                                            filters.customFieldIds.push(chkid);
                                            $(this).parent().addClass("close-list");
                                        }
                                        else {
                                            $(this).removeAttr('checked');
                                        }

                                    }
                                });
                                //Maintain CustomeField Count : 1954 By Maitri Gandhi
                                $("#SelectedCustomFilter_" + CustomFieldId).text(AutoSelectedCustomField);
                                AutoSelectedCustomField = 0;
                            }
                        }
                    }
                    else {
                        //Code for Select All : 1954 By Maitri Gandhi
                        $('#divCustomFieldsFilter').find("input[type=checkbox]").each(function () {
                            $(this).attr('checked', 'checked');
                            $(this).parent().addClass("close-list");
                            AutoSelectedCustomField++;
                        });
                        $('#ulSelectedFilter').find("li #CustomFields .sidebarliwidthSelected-right").text(FiltersAll);

                    }

                    if (data.OwnerNames.length != 0 && data.OwnerNames.length != undefined) {

                        filters.OwnerIds = [];
                        $("#ulSelectedOwner li input[type=checkbox]").removeAttr('checked');
                        $("#ulSelectedOwner li ").removeClass("close-list");
                        for (i = 0 ; i < data.OwnerNames.length; i++) {

                            $("#ulSelectedOwner li input[type=checkbox]").each(function () {

                                var Value = $(this).attr("id");
                                if (Value == data.OwnerNames[i]) {

                                    filters.OwnerIds.push(Value);
                                    $(this).attr('checked', 'checked');
                                    $(this).parent().addClass("close-list");
                                }
                            });
                        }
                    }

                    if (data.TTList != null) {
                        if (data.TTList.length != 0 && data.TTList.length != undefined) {
                            filters.TacticTypeids = [];
                            $("#ulTacticType li input[type=checkbox]").removeAttr('checked');
                            $("#ulTacticType li ").removeClass("close-list");
                            for (i = 0 ; i < data.TTList.length; i++) {

                                $("#ulTacticType li input[type=checkbox]").each(function () {

                                    var Value = $(this).attr("id").replace("CbTT", "");
                                    if (Value == data.TTList[i]) {
                                        filters.TacticTypeids.push(Value);
                                        $(this).attr('checked', 'checked');
                                        $(this).parent().addClass("close-list");
                                    }
                                });
                            }
                        }
                    }
                    else {
                        $("#ulTacticType li").each(function (i) {
                            $(this).removeClass("close-list");
                            var chkid = $(this).find("input[type=checkbox]").attr("id");
                            $("#" + chkid).removeAttr("checked");
                        });

                    }


                    if (data.Years != null) {
                        if (data.Years.length != 0 && data.Years.length != undefined) {
                            $("#ulSelectedYear li input[type=checkbox]").removeAttr('checked');
                            $("#ulSelectedYear li ").removeClass("close-list");
                            for (i = 0 ; i < data.Years.length; i++) {
                                $("#ulSelectedYear li input[type=checkbox]").each(function () {
                                    var Value = $(this).attr("yearvalue");
                                    if (Value == data.Years[i]) {
                                        filters.SelectedYears.push(Value);
                                        $(this).attr('checked', 'checked');
                                        $(this).parent().addClass("close-list");
                                    }

                                });

                            }
                        }
                    }
                }
                //Added by Maitri Gandhi for #2014 on 29/2/2016 to maintain selected preset
                if (presetName != 'undefined' && presetName != null && presetName != "") {
                    SaveLastSetofViews();
                }
                UpdateSelectedFilters();
            }
        });

    }

    function SaveLastSetofViews(ViewName) {
        filters.customFieldIds = [];
        filters.TacticTypeids = [];
        //modified by komak rawal for 1911 Owner filter is gettind deselected from moving to homepage from Report
        filters.OwnerIds = [];
        filters.parentCustomFieldsIds = [];

        $("#ulSelectedOwner li input:checkbox:checked").map(function () {
            filters.OwnerIds.push($(this).attr("id"));
        });
        //End
        $('#divCustomFieldsFilter').children().each(function () {
            var custID = $(this).attr("id");
            filters.parentCustomFieldsIds.push(custID.replace("accordion", ""));
        });
        $("#ulTacticType li input[type=checkbox]").each(function () {

            var chkid = $(this).attr("id");
            if ($(this).is(':checked')) {
                filters.TacticTypeids.push(chkid.replace("CbTT", ""));
            }
        });
        $('#divCustomFieldsFilter').find("input[type=checkbox]").each(function () {
            if ($(this).attr('checked') == 'checked') {
                var chkid = $(this).attr("id");
                if (chkid != undefined && chkid != 'undefined') {
                    filters.customFieldIds.push(chkid);
                }
            }
        });
        filters.SelectedPlans = [];
        $('#ulSelectedPlans').find("input[type=checkbox]").each(function () {
            if ($(this).attr('checked') == 'checked') {
                var chkid = $(this).attr("id");
                var chkplanid = chkid.split('_');
                if (chkid != undefined && chkid != 'undefined') {
                    filters.SelectedPlans.push(chkplanid[0]);
                }
            }
        });
        if (filters.SelectedPlans.length == 1) {
            CurrentPlanId = filters.SelectedPlans[0].toString();
            $("#CurrentPlanId").val(filters.SelectedPlans[0].toString());

        }

        filters.SelectedYears = [];
        var listCheckbox = $("#ulSelectedYear").find("input[type=checkbox]");
        years = "";
        $.each(listCheckbox, function () {
            if ($(this).attr("checked")) {
                years += $(this).attr('yearValue') + ",";
            }
        });
        years = years.slice(0, -1);
        if (years != null && years != "") {
            filters.SelectedYears.push(years);
        }
        //Commented By Komal Rawal for ticket 1802
        // var ulTacticType = $("#ulTacticType li");

        //if (ulTacticType.length == filters.TacticTypeids.length) {
        //    filters.TacticTypeids = [];
        //}
        //if (TacticDeselectAll) {
        //    filters.TacticTypeids.push(0);
        //}
        var Planid = filters.SelectedPlans;
        var CustomFieldId = filters.customFieldIds;
        var OwnerIds = filters.OwnerIds;
        var TacticTypeids = filters.TacticTypeids;
        var GetSelectedPlanNo = filters.SelectedPlans.length;
        var ParentCustomFieldsIds = filters.parentCustomFieldsIds;

        $.ajax({
            type: "POST",//Modified BY Komal Rawal for #1991 to solve json length problem in passing query string.
            cache: false,
            async: false,
            url: '@Url.Action("SaveLastSetofViews", "Home")',
            data: {
                PlanId: Planid.toString(),
                customFieldIds: CustomFieldId.toString(),
                ownerIds: OwnerIds.toString(),
                TacticTypeid: TacticTypeids.toString(),
                StatusIds: "Report",
                ViewName: ViewName,
                SelectedYears: filters.SelectedYears.toString(),
                ParentCustomFieldsIds: filters.parentCustomFieldsIds.toString()
            },
            dataType: "json",
            success: function (data) {
                if (data.isSuccess == true) {


                    if (data.ViewName != null && data.ViewName != "" && data.ViewName != undefined) {
                        $("#content_SaveFilters").css("display", "none");
                        $('#divsidebartoggle').css('display', 'block');//Add By nishant sheth // Desc :: To hide toggle button for preset save filter view
                        $("#btnreportSection").css("display", "block");
                        $("#Filtersidebar").css("display", "block");
                        $("#errorMessageMainSidebar").css("display", "none");
                        $('div[id=successMessageSidebar]').each(function () {
                            if ($(this).parent().is(':visible')) {
                                $(this).show();
                                $(this).find("span[id=spanSuccessMessageRole]").text('@Common.objCached.SavePresetSuccess');
                                // $(this).slideDown(600);
                                //$(this).slideDown(600).delay(3000).slideUp(600);
                            }
                        });

                        $("#txtPresetName").val('');
                    }
                }
                else {
                    $("#successMessageSidebar").css("display", "none");
                    $('div[id=errorMessageMainSidebar]').each(function () {
                        if ($(this).parent().is(':visible')) {
                            $(this).show();
                            $(this).find("span[id=spanErrorMessageRole]").text(data.msg);
                            // $(this).slideDown(600);
                            //$(this).slideDown(600).delay(3000).slideUp(600);
                        }
                    });

                }
            }

        })

    }

    function GetselectionFilter() {
        var yy = $(this);
        var arrOptionIds = new Array();
        //// close multiselect
        $(".budgetReportFilter-area").find(".multiselection-select").each(function () {
            $(this).multiselect("close");//"Close" is function in multiselect.js which close the multiselect menu
        });

        OptionMain = getYearSelectedValue(true);

        @foreach (var custField in ViewCustomFields)
        {
             string multiselectid = string.Concat("ul", custField.CustomFieldId);
           @: var filterIds = GetCustomFilterIds('@multiselectid');
                   @: var arrFilterId = filterIds.split(',');
                   @: if (arrFilterId != "")
                       @: {
                       @: for (var i = 0; i < arrFilterId.length; i++) {
                           @: arrOptionIds.push({ CustomFieldId: '@custField.CustomFieldId', OptionId: arrFilterId[i] });
                           @:}
                       @:}

            }

        //Added for "Select All" case of #1953 and #1993 By Maitri Gandhi on 16/2/2016
        var CheckedCounter = 0, AllCounter = 0, id = null, UncheckedCounter = 0;
        $("#divCustomFieldsFilter").find("div.accordion").each(function () {
            if ($(this).find("input[type=checkbox]") != null || $(this).find("input[type=checkbox]") != "") {
                AllCounter = $(this).find("input[type=checkbox]").length;
                CheckedCounter = $(this).find("input[type=checkbox]:checked").length;
                UncheckedCounter = AllCounter - CheckedCounter;
                if (AllCounter == UncheckedCounter) {
                    var Id = $(this).attr("id");
                  //  if (Id.indexOf("-") >= 0) {
                        Id = Id.replace('accordion', '');
                        var CustomId = null;
                        arrOptionIds.push({ CustomFieldId: Id, OptionId: CustomId });

                    //}
                }
                else if (AllCounter == CheckedCounter) {
                    id = this.id;
                    if (id != null && id != "") {
                        id = this.id.replace('accordion', '');
                    }
                    var i = 0, customfieldid;
                    for (i = 0; i < arrOptionIds.length; i++) {
                        customfieldid = arrOptionIds[i].CustomFieldId;
                        if (id == customfieldid) {
                            arrOptionIds.splice(i, 1);
                            i--;
                        }
                    }
                }
            }
        });        ////End

        //// get selected value from multiselect
        PlanIds = GetFilterIdForPlan(multiselectPlanId);
        //Mofied By Komal Rawal
        var arrPlanIds = new Array();
        arrPlanIds = PlanIds.split(',');
        var GetSelectedPlanNo = arrPlanIds.length;
        if (GetSelectedPlanNo > 1) {
            $("#divAddActual").hide();

        }
        else {
            $("#divAddActual").show();

        }
        //End

        SortingId = '';
        $.ajax({
            dataType: 'json',
            type: 'POST',
            url: '@Url.Content("~/Report/SetReportData/")',
            traditional: true,
            data: {
                planIds: PlanIds,
                OwnerIDs: (filters.OwnerIds).toString(),
                TactictypeIDs: (filters.TacticTypeids).toString(),
                customIds: JSON.stringify(arrOptionIds),
            },
            success: function (data) {
                if (data.status) {

                    if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Summary.ToString()') {
                        LoadSummary();
                    }
                    else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Revenue.ToString()') {
                        LoadRevenueData();
                    }
                    else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Waterfall.ToString()') {
                        LoadConversionData();
                    }
                    else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
                        LoadBudgetView();
                    }
                    else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Custom.ToString()') {
                        LoadAllReports();
                    }
                }

                //SaveLastSetofViews();
            }
        });
    }
    // <--- End document.ready Event --->
    function OnPlanchange(_plancheckbox) {
        var _checked = $(_plancheckbox).attr('checked');
        var _val = $(_plancheckbox).attr('id');
        //Modified by komal rawal to solve plan filter selection problem in reports.
        var _planliId = "liPlan" + "_" + _val;
        OnCheckboxChangeForPlan(_planliId, _checked);
    }

    function OnMultiselectchange(_checkbox, CustFieldId, count) {
        var _checked = $(_checkbox).attr('checked');
        var _val = $(_checkbox).attr('id');
        //Modified by komal rawal to solve Custom filter selection problem in reports.
        var _parentliId = "liCustom" + _val.split("_")[1];
        OnCheckboxChange(_parentliId, _checked, CustFieldId, count);
    }
    function OnCheckboxChangeForPlan(_parentliId, _checked) {

        //var isyearchange = false;
        //if (isyearchange != null && isyearchange != 'undefined' && isyearchange != '' && isLstPlan)
        //    isyearchange = true;
        if (_checked != null && _checked != 'undefined' && _checked === 'checked') {
            $("#" + _parentliId).addClass('close-list');
            PlanIds = GetFilterIdForPlan(multiselectPlanId);

            //GetOwnerListForFilter(PlanIds, true,true);
            //GetTacticTypelist(PlanIds, true);

        }
        else {
            $("#" + _parentliId).removeClass('close-list');
            PlanIds = GetFilterIdForPlan(multiselectPlanId);

            //GetOwnerListForFilter(PlanIds,true,true);
            // GetTacticTypelist(PlanIds, true);

        }
        checkedPlancount = $("#ulSelectedPlans li input:checkbox:checked").length;
        $('#cPlancount').text(checkedPlancount);

        if (checkedPlancount > 1) {
            $("#divAddActual").hide();
        }
        else if (checkedPlancount == 0) {
            $("#divAddActual").hide();
            $("#divShareRep").hide();
        }
        else {
            $("#divAddActual").show();
            $("#divShareRep").show();

        }
    }

    function OnCheckboxChange(_parentliId, _checked, CustFieldId, count) {
        var SelectedCustomFields = parseInt($("#SelectedCustomFilter_" + CustFieldId).text());
        if (_checked != null && _checked != 'undefined' && _checked === 'checked') {
            $("#" + _parentliId).addClass('close-list');
            SelectedCustomFields++;
            $("#SelectedCustomFilter_" + CustFieldId).text(SelectedCustomFields);
        }
        else {
            $("#" + _parentliId).removeClass('close-list');
            SelectedCustomFields--;
            $("#SelectedCustomFilter_" + CustFieldId).text(SelectedCustomFields);
        }
    }

    //// Load Check value in multiselect dropdown - common for all dropdown
    function LoadCheckBoxValue(multiselectId, filterid) {
        var finalValue = "";
        var isAll = true;
        $('#multipleselect_' + multiselectId).find("input[type='checkbox']").each(function () {
            if (this.checked) {
                finalValue += $(this).parent().find('span').eq(0).html() + ",  ";
            }
            else {
                isAll = false;
            }
        });
        finalValue = finalValue.slice(0, -3);
        if (finalValue == '') {
            finalValue = 'None';
        }
        if (isAll) {
            finalValue = 'All';
        }
        $(filterid).html(finalValue);
    }

    //function SetSelectedFilterText(multiselect_ul_Id, filterid) {
    //    var finalValue = "";
    //    var isAll = true;
    //    $('#' + multiselect_ul_Id).find("input[type='checkbox']").each(function () {
    //        if (this.checked) {
    //            finalValue += $(this).parent().find('span').eq(0).html() + ",  ";
    //        }
    //        else {
    //            isAll = false;
    //        }
    //    });
    //    finalValue = finalValue.slice(0, -3);
    //    if (finalValue == '') {
    //        finalValue = 'None';
    //    }
    //    if (isAll) {
    //        finalValue = 'All';
    //    }
    //    $(filterid).html(finalValue);
    //}

    //// Load Plan data based on selected year
    var _item;
    function LoadPlanData(years) {
        var strYear = years;
        if (OptionMain == 'thisquarter') {
            strYear = new Date().getFullYear();
        }
        // Addd By Nishant Sheth
        // Desc  :: #1842 code review - When we select the year from Year filter, plan selection is removed, It should not
        var selectedPlanIds = [];
        var listofselectedplan = $("#accordion-element-Plan").find("ul").find("li").find("input[type='checkbox']:checked");
        $.each(listofselectedplan, function () {

            var pid = $(this).attr('id').split('_')[0];
            selectedPlanIds.push(pid);
        });
        // End By Nishant Sheth

        $.ajax({
            beforeSend: function (x) {
                myApp.hidePleaseWait();
            },
            type: 'POST',
            url: '@Url.Content("~/Report/GetBudgetPlanBasedOnYear/")',
            data: {
                Year: strYear
            },
            success: function (data) {
                $('#' + multiselectPlanId).html('');
                if (data != 'undefined' && data != null) {
                    PlanCount = data.length;
                    if (PlanCount > 0) {
                        $("#PlanAllModule").css("display", "block");
                        $("#NoPlanFound").hide();
                        $.each(data, function (index, item) {
                            _item = item.Value.replace(/'/g, "&#39;"); //PL #1556 Reports: Clustered Plan Names - Dashrath Prajapati
                            $('#' + multiselectPlanId).append('<li class="accordion-inner" title="' + item.Text + '" id="liPlan' + item.Value + '"><span class="sidebarliwidth">' + item.Text + '</span><input type="checkbox" class="chkbxfilter" onchange="OnPlanchange(this)" id="' + _item + '"></input></li>');
                        });
                    }
                    else {
                        $("#PlanAllModule").css("display", "none");
                        $("#NoPlanFound").show();
                    }
                }
                else {
                    $("#PlanAllModule").css("display", "none");
                    $("#NoPlanFound").show();

                }

                // Addd By Nishant Sheth
                // Desc  :: #1842 code review - When we select the year from Year filter, plan selection is removed, It should not
                var listofplan = $("#accordion-element-Plan").find("ul").find("li").find("input[type='checkbox']");
                $.each(listofplan, function () {

                    var pid = $(this).attr('id').split('_')[0];
                    var indexofplan = $.inArray(pid, selectedPlanIds);
                    if (indexofplan > -1) {
                        $(this).attr("checked", "checked");
                        //Commented By komal rawal for 1984 owner did not remain selected when year changes.
                        // OnPlanchange($(this));
                    }
                });
                // End By Nishant Sheth
                PlanIds = GetFilterIdForPlan(multiselectPlanId);
                //GetTacticTypelist(PlanIds,true,true);// Modified By Nishant Sheth #1956 : Enable async true paramter
                //GetOwnerListForFilter(PlanIds, true, true);// Modified By Nishant Sheth #1956 : Enable async true paramter
                // Added By Rahul Shah
                // Desc :: To resolve the internal review points to mismatch Plan selection count on Year change
                checkedPlancount = $("#ulSelectedPlans li input:checkbox:checked").length;
                $('#tPlancount').text('/' + PlanCount);
                $('#cPlancount').text(checkedPlancount);
            }
        });
    }

    function BulkPlanOperation(selection) {
        var PlanIds = [];
        var ulPlanli = "#" + multiselectPlanId + " li";
        if (selection) {
            $(ulPlanli).each(function (i) {
                $(this).addClass("close-list");
                var chkid = $(this).find("input[type=checkbox]").attr("id");
                $("#" + chkid).attr("checked", "checked");
            });
        }
        else {
            IsDeselectAll = true;
            IsDeselectAllTactics = true;
            $(ulPlanli).each(function (i) {
                $(this).removeClass("close-list");
                var chkid = $(this).find("input[type=checkbox]").attr("id");
                $("#" + chkid).removeAttr("checked");
            });
        }
        checkedPlancount = $("#ulSelectedPlans li input:checkbox:checked").length;
        $('#cPlancount').text(checkedPlancount);
        PlanIds = GetFilterIdForPlan(multiselectPlanId);
        //Commented By Maitri Gandhi on 24/2/2016 For #2014
        //GetOwnerListForFilter(PlanIds,true,true);
        //GetTacticTypelist(PlanIds, true,true);

    }

    function BulkCustomFieldOperation(selection, ulCutomFieldId, TotalCount) {
        var ul_lis = "#" + ulCutomFieldId + " li";
        if (selection) {
            $(ul_lis).each(function (i) {
                $(this).addClass("close-list");
                var chkid = $(this).find("input[type=checkbox]").attr("id");
                $("#" + chkid).attr("checked", "checked");
            });
            $("#SelectedCustomFilter_" + ulCutomFieldId.replace('ul', '')).text(TotalCount);
        }
        else {
            $(ul_lis).each(function (i) {
                $(this).removeClass("close-list");
                var chkid = $(this).find("input[type=checkbox]").attr("id");
                $("#" + chkid).removeAttr("checked");
            });
            $("#SelectedCustomFilter_" + ulCutomFieldId.replace('ul', '')).text("0");
        }
    }

    //// Remove actiave class from left sidebar menu li
    function RemoveAllActiveItem() {
        $('#ulLeftPane li').each(function () {
            if ($(this).hasClass('active')) {
                $(this).removeClass('active');
            }
        });
    }

    //// Modified by Arpita Soni for Ticket #1148 on 01/23/2015
    ///Added by Mitesh Vaishnav for PL ticket #846
    ///If running tab is budgeting than show specific filters
    function ShowFilters() {

        @foreach (var custField in ViewCustomFields)
            {
                string btnmultiselectid = string.Concat("#btnMultiselect_ddlView", custField.CustomFieldId);
                string lblid = string.Concat("lbl", custField.CustomFieldId);
                string detailid = string.Concat(custField.CustomFieldId, "detail");
                    @: $('@btnmultiselectid').css('display', 'initial');
                                                                                @: $('@lblid').css('display', 'initial');
                                                                                @: $('@detailid').css('display', 'initial');
                                        }
    }

    //// Load Summary view using ajax - partial view
    function LoadSummary() {
        $('#budgetHeader').css('display', 'none');
        $('#UlPlanHeader').css('display', 'block');
        $('#formSideFilter').css('display', 'block');
        $('#divMainReportPart').empty();
        $('#conversionHeader').css('display', 'none');
        $('#revenueHeader').css('display', 'none');
        $("#BtnShareReport").show();
        $('#accordion-quart').css('display', 'block');
        @* var url = '@Url.Content("~/Report/GetSummaryData/")';
        $('#divMainReportPart').load(url , function () {*@

        if (Qurt_Month == "Monthly") {
            $("#ddlAllocate option[value='months']").attr("selected", "selected");
            $("#ddlAllocate option[value='quarters']").attr("selected", false);
        }
        else {
            $("#ddlAllocate option[value='quarters']").attr("selected", "selected");
            $("#ddlAllocate option[value='months']").attr("selected", false);
        }
        $('.sbSelector').text(Qurt_Month);

        var url = '@Url.Content("~/Report/GetOverviewData/")';
        $('#divMainReportPart').load(url + '?timeframeOption=' + OptionMain + '&isQuarterly=' + Qurt_Month, function () {
            isAllowClick = true;
            myApp.hidePleaseWait();
            //Added By Maitri Gandhi on 25/3/2016 for #2044
            if ($(".popover.fade.top.in").length != 0) {
                $(".popover.fade.top.in").remove();
            }
        });

    }

    //// Load Revenue view section
    function LoadRevenueView() {
        $('#conversionHeader').css('display', 'none');
        $('#revenueHeader').css('display', 'none');
    }

    //// Load Conversion view section
    function LoadConversionView() {
        $('#conversionHeader').css('display', 'block');
        $('#revenueHeader').css('display', 'none');
    }
    $("#BtnAddActual").click(function () {
        //Button of add actual only display when single plan selected
        var planIdForAddActual = GetFilterIdForPlan(multiselectPlanId);
        if (planIdForAddActual != "" && planIdForAddActual != null) {
        var url = '@Url.Action("AddActual", "Plan")' + '?PlanId=' + planIdForAddActual;
        window.location.href = url;
        }
    });
    //// Call function based on option
    function loadBasedOnPlan() {

        var isActualVisible = "@ViewBag.TacticActualsAddEdit"
        if (isActualVisible.toString().toLowerCase() == 'true') {
            if (SelectedPlanId == 0) {
                $("#BtnAddActual").attr("disabled", "disabled");
            }
            else {
                $("#BtnAddActual").removeAttr("disabled");
            }
        }

        if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Summary.ToString()') {
            LoadSummary();
        }
        else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Revenue.ToString()') {
            LoadRevenueData();
        }
            //PL 1562 Dashrath Prajpati
        else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Waterfall.ToString()') {
            LoadConversionData();
        }
    }

    //// Load Revenue Data
    function LoadRevenueData() {
        $('#budgetHeader').css('display', 'none');
        $('#UlPlanHeader').css('display', 'block');
        $('#formSideFilter').css('display', 'block');
        $("#BtnShareReport").show();
        $('#divMainReportPart').empty();
        $('#accordion-quart').css('display', 'none');

        @*var url = '@Url.Content("~/Report/GetRevenueData/")';
        $('#divMainReportPart').load(url + '?timeFrameOption=' + OptionMain , function () {
            isAllowClick = true;
            myApp.hidePleaseWait();
        });*@

        var url = '@Url.Content("~/Report/GetRevenueData/")';
        $('#divMainReportPart').load(url + '?option=' + OptionMain + '&isQuarterly=' + Qurt_Month, function () {
            isAllowClick = true;
            myApp.hidePleaseWait();
            //Added By Maitri Gandhi on 25/3/2016 for #2044
            if ($(".popover.fade.top.in").length != 0) {
                $(".popover.fade.top.in").remove();
            }
        });
    }

    //// Load Conversion Data
    function LoadConversionData() {
        $('#budgetHeader').css('display', 'none');
        $('#UlPlanHeader').css('display', 'block');
        $('#formSideFilter').css('display', 'block');
        $("#BtnShareReport").show();
        //$('#divMainReportPart').empty();
        $('#accordion-quart').css('display', 'none');
        $('#conversionHeader').css('display', 'none'); //added by dashrath prajapati for new design of conversion partial page
        $('#revenueHeader').css('display', 'none'); //added by dashrath prajapati for new design of conversion partial page

        @*  var url = '@Url.Content("~/Report/GetConversionData/")';*@
        //$('#divMainReportPart').load(url + '?timeFrameOption=' + OptionMain , function () {
        //    isAllowClick = true;
        //    myApp.hidePleaseWait();
        //});

        var url = '@Url.Content("~/Report/GetWaterFallData/")';
        $('#divMainReportPart').load(url + '?timeFrameOption=' + OptionMain + '&isQuarterly=' + Qurt_Month, function () {
            isAllowClick = true;
            myApp.hidePleaseWait();
            //Added By Maitri Gandhi on 25/3/2016 for #2044
            if ($(".popover.fade.top.in").length != 0) {
                $(".popover.fade.top.in").remove();
            }
        });
    }

    //// Load Budget View
    function LoadBudgetView() {

        //modified by Rahul Shah on 19/02/2016 for PL #1975. for Passing the customfield,OwnerIds,TacticType for display viewBy options according to it.
        filters.customFieldIds = [];
        filters.OwnerIds = [];
        //filters.TacticTypeids = [];
        $('#divCustomFieldsFilter').find("input[type=checkbox]").each(function () {
            if ($(this).attr('checked') == 'checked') {
                var chkid = $(this).attr("id");
                if (chkid != undefined && chkid != 'undefined') {
                    filters.customFieldIds.push(chkid);
                }
            }
        });

        // modified by Rahul Shah "Viewby" dropdown of Report->Finance tab not filled customfields when all customfields of left pane are selected.
        var CheckedCounter = 0, AllCounter = 0, id = null, UncheckedCounter = 0;
        $("#divCustomFieldsFilter").find("div.accordion").each(function () {
            if ($(this).find("input[type=checkbox]") != null || $(this).find("input[type=checkbox]") != "") {
                AllCounter = $(this).find("input[type=checkbox]").length;
                CheckedCounter = $(this).find("input[type=checkbox]:checked").length;
                UncheckedCounter = AllCounter - CheckedCounter;
                if (AllCounter == UncheckedCounter) {
                    var Id = $(this).attr("id");
                   // if (Id.indexOf("-") >= 0) {
                        Id = Id.replace('accordion', '');
                        var CustomId = Id + "_null";
                        filters.customFieldIds.push(CustomId);

                   // }
                }
                else if (AllCounter == CheckedCounter) {
                    //id = this.id;
                    id = this.id.replace('accordion', '');                    
                    var i = 0, customfieldid;
                    for (i = 0; i < filters.customFieldIds.length; i++) {
                        if (filters.customFieldIds[i].indexOf("_") > -1) {
                            customfieldid = filters.customFieldIds[i].split("_")[0];
                            if (id == customfieldid) {
                                filters.customFieldIds.splice(i, 1);
                                i--;
                            }
                        }
                    }
                }
            }
        });
        $("#ulSelectedOwner li input[type=checkbox]:checked").each(function () {
            filters.OwnerIds.push($(this).attr("id"));

        });


        $("#ulTacticType li input[type=checkbox]").each(function () {

            var chkid = $(this).attr("id");
            if ($(this).is(':checked')) {
                filters.TacticTypeids.push(chkid.replace("CbTT", ""));
            }
        });

        var CustomFieldId = filters.customFieldIds.toString();
        var TactitTypeId = filters.TacticTypeids.toString();
        var OwnerId = filters.OwnerIds.toString();

        $("#BtnShareReport").hide(); //Added by Arpita Soni on 01/08/2015 for ticket #1108
        $('#budgetHeader').css('display', 'block');
        $('#conversionHeader').css('display', 'none');
        $('#revenueHeader').css('display', 'none');
        $('#UlPlanHeader').css('display', 'none');
        $('#formSideFilter').css('display', 'none');
        $('#accordion-quart').css('display', 'none');
        var url = '@Url.Content("~/Report/GetBudget/")';
        // Commented By Nishant Sheth
        // Desc :: To handle the max querstring length
        //$('#divMainReportPart').load(url + '?CustomFieldId=' + CustomFieldId + '&TactitTypeId=' + TactitTypeId + '&OwnerId=' + OwnerId, function () {
        //        isAllowClick = true;
        //});

        // Add By Nishant Sheth
        // Desc :: To handle the max querstring length 
        $.ajax({
            type: 'POST',
            url: url,
            data: {
                CustomFieldId: CustomFieldId,
                TactitTypeId: TactitTypeId,
                OwnerId: OwnerId
            },
            success: function (response) {
                $('#divMainReportPart').html('');
                $('#divMainReportPart').html(response);
                isAllowClick = true;
                //Added By Maitri Gandhi on 25/3/2016 for #2044
                if ($(".popover.fade.top.in").length != 0) {
                    $(".popover.fade.top.in").remove();
                }
            }
        });
    }

    //// Get Plan Ids from multiselect list
    function GetFilterIdForPlan(ulPlanId) {
        //  myApp.showPleaseWait();// add by nishant sheth // Comment by bhavesh
        var finalValue = "";
        var isShowAddActual = 0;
        $('#' + ulPlanId).find("input[type='checkbox']").each(function () {
            if (this.checked) {
                $(this).parent().addClass("close-list");
                isShowAddActual++;
                var splitvalue = $(this).attr('id').split("_");
                finalValue += splitvalue[0] + ",";
            }
            else
            {
                $(this).parent().removeClass("close-list");

            }
        });

        finalValue = finalValue.slice(0, -1);
        if (finalValue == '') {
            finalValue = '';
        }
        //if (isShowAddActual == 1) {
        //    $("#divAddActual").css("display", "block");
        //}
        //else {
        //    $("#divAddActual").css("display", "none");
        //}

        return finalValue;

    }

    //// Get id from multiselect
    function GetCustomFilterIds(ulCustomId) {
        var finalValue = "";
        $('#' + ulCustomId).find("input[type='checkbox']").each(function () {
            if (this.checked) {
                finalValue += $(this).attr('id') + ",";
            }
        });

        finalValue = finalValue.slice(0, -1);
        if (finalValue == '') {
            finalValue = '';
        }
        return finalValue;
    }

    //// Load Budget Data
    function LoadBudgetData() {
        if (isByAllocated) {
            myApp.showPleaseWait();
            $('#divTabData').load('@Url.Action("GetReportBudgetData", "Report")' + '?Year=' + OptionMain + '&AllocatedBy=' + AllocatedBy + '&Tab=' + Tab + '&SortingId=' + SortingId, function () {
                myApp.hidePleaseWait();
            });

        }
    }

    //// Load Share report section
    function ShowShareReport() {
        var url = '@Url.Content("~/Report/ShowShareReport/")';
        $("#DivShareReport").empty()
                                   .load(url.concat('?reportType=') + leftPaneOption)
                                   .show();
    }

    //// on select simple selector dropdown close multiselect dropdown
    $(".sbSelector").click(function () {
        $(".ui-multiselect-menu").each(function () {
            $(this).css("display", "none");
        });
    });

    //// handle update button event

    var SavePresetValue = false;
    //$('#updatedata').click(function ()

    function updatedata() {

        var arrOptionIds = new Array();
        //// close multiselect
        $(".budgetReportFilter-area").find(".multiselection-select").each(function () {
            $(this).multiselect("close");//"Close" is function in multiselect.js which close the multiselect menu
        });

        OptionMain = getYearSelectedValue(true);

        //  Qurt_Month = getQuarterMonthlySelectedValue();

        @foreach (var custField in ViewCustomFields)
        {
            string multiselectid = string.Concat("ul", custField.CustomFieldId);
           @: var filterIds = GetCustomFilterIds('@multiselectid');
           @: var arrFilterId = filterIds.split(',');
           @: if(arrFilterId != "")
           @: {
           @: for (var i = 0; i < arrFilterId.length; i++) {
           @: arrOptionIds.push({ CustomFieldId: '@custField.CustomFieldId', OptionId: arrFilterId[i] });
           @:}
           @:}
        }

        //Added for "Select All" case of #1953 and #1993 By Maitri Gandhi on 16/2/2016
        var CheckedCounter = 0, AllCounter = 0, id = null, UncheckedCounter = 0;
        $("#divCustomFieldsFilter").find("div.accordion").each(function () {
            if ($(this).find("input[type=checkbox]") != null || $(this).find("input[type=checkbox]") != "") {
                AllCounter = $(this).find("input[type=checkbox]").length;
                CheckedCounter = $(this).find("input[type=checkbox]:checked").length;
                UncheckedCounter = AllCounter - CheckedCounter;
                if (AllCounter == UncheckedCounter) {
                    var Id = $(this).attr("id");
                  //  if (Id.indexOf("-") >= 0) {
                       Id = Id.replace('accordion', '');
                        var CustomId = null;
                        arrOptionIds.push({ CustomFieldId: Id, OptionId: CustomId });

                   // }
                }
                else if (AllCounter == CheckedCounter) {
                    id = this.id;
                    if (id != null && id != "") {
                        id = this.id.replace('accordion', '');
                    }
                    var i = 0, customfieldid;
                    for (i = 0; i < arrOptionIds.length; i++) {
                        customfieldid = arrOptionIds[i].CustomFieldId;
                        if (id == customfieldid) {
                            arrOptionIds.splice(i, 1);
                            i--;
                        }
                    }
                }
            }
        });        ////End

        filters.OwnerIds = [];
        $("#ulSelectedOwner li input[type=checkbox]").each(function () {
            var chkid = $(this).attr("id");
            if ($(this).is(':checked')) {
                filters.OwnerIds.push(chkid);
            }
        });

        filters.TacticTypeids = [];
        $("#ulTacticType li input[type=checkbox]").each(function () {
            var chkid = $(this).attr("id");
            if ($(this).is(':checked')) {
                filters.TacticTypeids.push(chkid.replace("CbTT", ""));
            }
        });
        //// get selected value from multiselect
        PlanIds = GetFilterIdForPlan(multiselectPlanId);
        //Mofied By Komal Rawal
        var arrPlanIds = new Array();
        if (PlanIds != "") {
            arrPlanIds = PlanIds.split(',');
        }
        
        var GetSelectedPlanNo = arrPlanIds.length;
        if (GetSelectedPlanNo > 1) {
            $("#divAddActual").hide();
        }
        else if (GetSelectedPlanNo == 0) {
            $("#divAddActual").hide();
            $("#divShareRep").hide();
        }
        else {
            $("#divAddActual").show();
            $("#divShareRep").show();

        }
        //End

        SortingId = '';
        $.ajax({
            dataType: 'json',
            type: 'POST',
            url: '@Url.Content("~/Report/SetReportData/")',
        traditional: true,
        data: {
            planIds: PlanIds,
            OwnerIDs: (filters.OwnerIds).toString(),
            TactictypeIDs: (filters.TacticTypeids).toString(),
            customIds: JSON.stringify(arrOptionIds),
        },
        success: function (data) {
            if (data.status) {
                if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Summary.ToString()') {
                    LoadSummary();
                }
                else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Revenue.ToString()') {
                    LoadRevenueData();
                }
                else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Waterfall.ToString()') {
                    LoadConversionData();
                }
                else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
                    LoadBudgetView();
                }
                else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Custom.ToString()') {
                    LoadAllReports();
                }
            }


        }
    });

    if (SavePresetValue == false) {
        SaveLastSetofViews();
    }
    SavePresetValue = false;
    UpdateSelectedFilters();
    };

    function UpdatePlan() {

        //Added by Maitri Gandhi for #2040 on 31/3/2016
        
        var cookie = document.cookie;
        if (cookie.indexOf("gridOpengridbox") > -1) {
            var cookies = cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                if (cookies[i].indexOf("gridOpengridbox") > -1) {
                    cookies[i] = "gridOpengridbox=plan.1";
                }
            } document.cookie = "gridOpengridbox=plan.1";
            //document.cookie = cookies.join(';');
        }
        else {
            //cookie += "; gridOpen=plan.1";
            document.cookie = "gridOpengridbox=plan.1";
        }
        //Checked All Filters and Load Owner nd tactic type

        var planids = [];
        $('#ulSelectedPlans').find("input[type=checkbox]:checked").each(function () {
            var chkid = $(this).attr("id");
            if (chkid != undefined && chkid != 'undefined') {
                chkid = chkid.split('_')[0]; // komal 24-02
                planids.push(chkid);
            }
        });
        if (planids.length > 0) {
            $('#divCustomFieldsFilter').find("input[type=checkbox]").each(function () {
                $(this).attr('checked', 'checked');
                $(this).parent().addClass("close-list");
            });
        } else {
            $('#divCustomFieldsFilter').find("input[type=checkbox]:checked").each(function () {
                $(this).removeAttr('checked');
                $(this).parent().removeClass("close-list");
            });
        }
        GetTacticTypelist(planids, false);
        GetOwnerListForFilter(planids, false);
        UpdateSelectedFilters();
        updatedata();
    }
    //Added By Maitri Gandhi on 24/2/2016 For #2014
    function ApplyFilters() {        
        updatedata();
    }

    ////Added to set filters count and selected filters name : 1954 By Maitri Gandhi
    function UpdateSelectedFilters() {
        //set custom field filters
        $("#ulSelectedFilter").find("li #CustomFields .sidebarliwidthselected-right").text("");
        var CheckedCounter = 0, AllCounter = 0, CurrentText = "", id = null;
        $("#divCustomFieldsFilter").find("div.accordion").each(function () {
            CheckedCounter = 0; AllCounter = 0; CurrentText = ""; id = null;
            if ($(this).find("input[type=checkbox]") != null || $(this).find("input[type=checkbox]") != "") {
                AllCounter = $(this).find("input[type=checkbox]").length;
                CheckedCounter = $(this).find("input[type=checkbox]:checked").length;
                $(this).find("input[type=checkbox]:checked").each(function () {

                    CurrentText = CurrentText + ", " + $($(this).parent()).find("span.sidebarliwidth").text();
                });
            }
            //id = this.id.split("-")[1];
            id = this.id;
            if (id != null && id != "") {
                id = this.id.replace('accordion', '');
            }


            if (CheckedCounter == AllCounter) {
                $("#ulSelectedFilter").find("#lstCustomFieldSelected_" + id).text(FiltersAll);
                $("#SelectedCustomFilter_" + id).text(CheckedCounter);
            }
            else {
                if (CheckedCounter == 0) {
                    $("#ulSelectedFilter").find("#lstCustomFieldSelected_" + id).text(FiltersNone);
                    $("#SelectedCustomFilter_" + id).text("0");

                }
                else {
                    CurrentText = CurrentText.substring(1);
                    $("#ulSelectedFilter").find("#lstCustomFieldSelected_" + id).text(CurrentText);
                    $("#SelectedCustomFilter_" + id).text(CheckedCounter);
                }
            }
        });
        //set static-default field filters
        selectedFilters.ownerName = [];
        selectedFilters.tacticTypeTitle = [];
        selectedFilters.yearIds = [];
        selectedFilters.planName = [];

        $("#ulSelectedYear li input[type=checkbox]:checked").each(function () {
            selectedFilters.yearIds.push($(this).attr("yearvalue"));
        });
        if (selectedFilters.yearIds.length == 0) {
            //$('#lstYear').text(FiltersNone);
            $('#lstYearActive').text(FiltersNone);
        }
        else if ($("#ulSelectedYear li").length == selectedFilters.yearIds.length) {
            //$('#lstYear').text(FiltersAll);
            $('#lstYearActive').text(FiltersAll);
        }

        else {
            //$('#lstYear').text(selectedFilters.yearIds.join(", "));
            $('#lstYearActive').text(selectedFilters.yearIds.join(", "));
        }

        $("#ulSelectedPlans li input[type=checkbox]:checked").each(function () {
            selectedFilters.planName.push($(this).parent().attr("title"));
        });
        if (selectedFilters.planName.length == 0) {
            //$('#lstPlan').text(FiltersNone);
            $('#lstPlanActive').text(FiltersNone);
        }
        else if ($("#ulSelectedPlans li").length == selectedFilters.planName.length) {
            //$('#lstPlan').text(FiltersAll);
            $('#lstPlanActive').text(FiltersAll);
        }
        else {
            //$('#lstPlan').text(selectedFilters.planName.join(", "));
            $('#lstPlanActive').text(selectedFilters.planName.join(", "));
        }

        checkedyearcount = selectedFilters.yearIds.length;
        $('#cYearcount').text(checkedyearcount);
        checkedplancount = selectedFilters.planName.length;
        $('#cPlancount').text(checkedplancount);
        $('#tPlancount').text("/" + $("#ulSelectedPlans li").length.toString());

        $("#ulSelectedOwner li input[type=checkbox]:checked").each(function () {
            selectedFilters.ownerName.push($(this).attr('ownertitle').toString());

        });
        if (selectedFilters.ownerName.length == 0) {
            $('#lstOwner').text(FiltersNone);
        }
        else if ($("#ulSelectedOwner li").length == selectedFilters.ownerName.length) {
            $('#lstOwner').text(FiltersAll);
        }
        else {
            $('#lstOwner').text(selectedFilters.ownerName.join(", "));
        }

        $("#ulTacticType li input[type=checkbox]:checked").each(function () {
            var objtactictypetitle = $(this).attr('tactictypetitle');
            if (objtactictypetitle != null && objtactictypetitle != undefined && objtactictypetitle != 'undefined')
            {
            selectedFilters.tacticTypeTitle.push($(this).attr('tactictypetitle').toString());
            }
        });
        if (selectedFilters.tacticTypeTitle.length == 0) {
            $('#lstTType').text(FiltersNone);
        }
        else if ($("#ulTacticType li").length == selectedFilters.tacticTypeTitle.length) {

            $('#lstTType').text(FiltersAll);
        }
        else {
            $('#lstTType').text(selectedFilters.tacticTypeTitle.join(", "));
        }

        checkedttcount = selectedFilters.tacticTypeTitle.length;
        $('#cTTcount').text(checkedttcount);

        checkedownercount = selectedFilters.ownerName.length;
        $('#cOwnercount').text(checkedownercount);

    }

    function OnYearChange(_yearli) {
        //$(_yearli).siblings().each(function () {
        //    $(this).removeClass('close-list');
        //});

        var id = $(_yearli).attr('id');
        if ($(_yearli).is(':checked')) {
            $("#" + id).addClass("close-list");
        }
        else {
            $("#" + id).removeClass("close-list");
        }
        checkedYearcount = $('#ulSelectedYear li input:checked').length;
        $('#cYearcount').text(checkedYearcount);
        //added by devanshi for PL ticket #2175
        if (checkedYearcount == 0)
        {
            $("#divAddActual").hide();
            $("#divShareRep").hide();
        }
       
        //$(_yearli).addClass('close-list');
        // Add By Nishant Sheth
        // Desc :: #1842 multiple year selection base on #1821
        var listCheckbox = $("#ulSelectedYear").find("input[type=checkbox]");
        years = "";
        $.each(listCheckbox, function () {
            if ($(this).attr("checked")) {
                years += $(this).attr('yearValue') + ",";
            }
        });
        years = years.slice(0, -1);
        if (years != null && years != "") {
            filters.SelectedYears.push(years);
        }
        //OptionMain = $(_yearli).attr('yearValue');
        //OptionMain = years;
        if (IsCallFromYearDropdown) {
            LoadPlanData(years);
        }
        //var _yearText = $(_yearli).attr('title');
        //$("#spYearText").html(_yearText);
        //$("#aYear").click();
    }

    //function OnTimeFrameChange(_quartmonthli) {
    //    $(_quartmonthli).siblings().each(function () {
    //        $(this).removeClass('close-list');
    //    });
    //    $(_quartmonthli).addClass('close-list');
    //    Qurt_Month = $(_quartmonthli).attr('timeframe-val');

    //    var _timeframeText = $(_quartmonthli).attr('title');
    //    $("#spTimeFrameText").html(_timeframeText);
    //    $("#aTimeFrame").click();
    //}

    function LoadYearDropdown() {
        var isClick = false;
        var ul_lis = "#ulSelectedYear li";
        $(ul_lis).each(function (i) {
            var _yearValue = $(this).attr('yearValue');

            /* Hide 'thisquarter' item from dropdown for Summary & Budget tab.*/
            if (_yearValue == 'thisquarter') {
                if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Summary.ToString()') {
                    isClick = true;
                }
                else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Revenue.ToString()') {
                    isClick = false;
                }
                    //PL 1562 Dashrath Prajpati
                else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Waterfall.ToString()') {
                    isClick = false;
                }
                else if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
                    isClick = true;
                }

                if (isClick == true) {
                    $(this).css('display', 'none');
                }
                else {
                    $(this).css('display', 'block');
                }
            }
        });
        var selectedValue = getYearSelectedValue(false);
        $(ul_lis).each(function (i) {
            if (isClick == true && selectedValue == 'thisquarter') {
                var _currentliValue = $(this).attr('yearValue');
                if (_currentliValue == '@RevenuePlanner.Helpers.Common.GetCurrentYear()') {
                    IsCallFromYearDropdown = false;
                    $(this).click();
                    IsCallFromYearDropdown = true;
                }
            }
        });
    }

    function getYearSelectedValue(isYearDetail) {
        //var _selecteditem = '';
        //$('#ulSelectedYear li').each(function () {
        //    if ($(this).hasClass('close-list')) {
        //        _selecteditem = $(this);
        //    }
        //});
        // Add By Nishant Sheth
        // Desc :: #1842 multiple year selection base on #1821
        var listCheckbox = $("#ulSelectedYear").find("input[type=checkbox]");
        var years = "";
        $.each(listCheckbox, function () {
            if ($(this).attr("checked")) {
                years += $(this).attr('yearValue') + ",";
            }
        });
        years = years.slice(0, -1);
        // End By Nishant Sheth
        //var _selectedYear = $(_selecteditem[0]).attr('yearValue');
        //if (isYearDetail) {
        //    var _YearText = $(_selecteditem).find('span').eq(0).html();
        //    $("#spYearText").html(_YearText);
        //}

        return years;
    }

    function getQuarterMonthlySelectedValue() {
        var _selecteditem = '';
        $('#ulSelectedQuart li').each(function () {
            if ($(this).hasClass('close-list')) {
                _selecteditem = $(this);
            }
        });
        var _selected = $(_selecteditem[0]).attr('timeframe-val');

        //var _YearText = $(_selecteditem).find('span').eq(0).html();
        //$("#spYearText").html(_YearText);

        return _selected;
    }

    //// summary click event
    $('#liSummary').click(function () {
        if (isAllowClick) {
            document.title = "Summary";
            isAllowClick = false;
            if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
                leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Summary.ToString()';
                //GetTacticTypelist(PlanIds, true);
                //GetOwnerListForFilter(PlanIds, true);
               
            }
            leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Summary.ToString()';
            LoadYearDropdown(leftPaneOption);
            RemoveAllActiveItem();
            $(this).addClass('active');
            $('#ddlsection').show(); //Modified for #1296
            $('#ddlCustomTimeFrame').hide(); //Add By Nishant Sheth #2262
            //loadBasedOnPlan(); // Commented By Nishant Sheth #1839 code review filters are not applied.
            GetselectionFilter();
        }
    });

    //// revenue click event
    $('#liRevenue').click(function () {
        if (isAllowClick) {
            document.title = "Revenue";
            isAllowClick = false;
            if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
                leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Revenue.ToString()';
                //GetTacticTypelist(PlanIds, true);
                //GetOwnerListForFilter(PlanIds, true);
                
            }
            leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Revenue.ToString()';
            LoadYearDropdown(leftPaneOption);
            RemoveAllActiveItem();
            $(this).addClass('active');
            $('#ddlsection').hide(); //Modified for #1296
            $('#ddlCustomTimeFrame').hide(); //Add By Nishant Sheth #2262
            LoadRevenueView();
            //loadBasedOnPlan(); // Commented By Nishant Sheth #1839 code review filters are not applied.
            GetselectionFilter();
        }
    });

    //// conversion click event
    $('#liConversion').click(function () {
        if (isAllowClick) {
            document.title = "Waterfall";
            isAllowClick = false;
            if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
                leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Waterfall.ToString()';
                //GetTacticTypelist(PlanIds, true);
                //GetOwnerListForFilter(PlanIds, true);
              
            }
            leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Waterfall.ToString()';  //PL 1562 Dashrath Prajpati
            LoadYearDropdown(leftPaneOption);
            RemoveAllActiveItem();
            $(this).addClass('active');
            $('#ddlsection').hide(); //Modified for #1296
            $('#ddlCustomTimeFrame').hide(); //Add By Nishant Sheth #2262
            LoadConversionView();
            //loadBasedOnPlan(); // Commented By Nishant Sheth #1839 code review filters are not applied.
            GetselectionFilter();
        }
    });

    //// budget click event
    $('#liBudgetreport').click(function () {
        if (isAllowClick) {
            document.title = "Finance"; //PL#1545 Dashrath Prajapati
            isAllowClick = false;
            if (leftPaneOption != '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
                leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()';
                //modified by Rahul Shah on 19/02/2016 for PL #1975.
                //GetTacticTypelist(PlanIds, false);
                //GetOwnerListForFilter(PlanIds, false);
              
            }
            leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()';
            LoadYearDropdown(leftPaneOption);
            RemoveAllActiveItem();
            $(this).addClass('active');
            $('#ddlsection').hide(); //Modified for #1296
            $('#ddlCustomTimeFrame').hide(); //Add By Nishant Sheth #2262
            GetselectionFilter();
            //LoadBudgetView();
        }
    });

    //// share report event
    $("#BtnShareReport").click(function () {
        ShowShareReport();
    });

    // Start:- Linchart script
    function BindLineChart(_categories, _plotlineVal, _isshowPlotLine, _series, _linechartDivId, _chartHeight, _plotOptions) {
        Highcharts.setOptions({
            lang: {
                numericSymbols: ["k", "M", "B", "T", "P", "E"]
            }
        });
        var options = {
            chart: {
                height: _chartHeight,
                //width: _chartwidth,
                spacingTop: 50
            },
            colors: ['#B04499', '#999999'],
            legend: {
                align: 'top',
                verticalAlign: 'top',
                layout: 'horizontal',
                x: 60,
                y: -40
            },
            title: {
                text: ''
            },
            xAxis: {
                categories: _categories,
                lineColor: 'black',
                lineWidth: 2,
                tickColor: 'black',
                tickWidth: 2,
                plotLines: _isshowPlotLine.toLowerCase() == "true" ? [{
                    color: 'black', // Color value
                    dashStyle: 'longdash', // Style of the plot line. Default to solid
                    value: _plotlineVal, // Value of where the line will appear
                    width: 2, // Width of the line
                    label: {
                        text: 'Today',
                        align: 'middle',
                        verticalAlign: 'top',
                        rotation: 0,
                        x: -15,
                        y: -2
                    }
                }] : [],
                tickPosition: 'inside',
                tickmarkPlacement: 'on',
                labels: {
                    color: '#2d2d2d',
                    style: {
                        "fontWeight": "bold"
                    }
                }
            },
            yAxis: {
                lineColor: 'black',
                gridLineWidth: 0,
                minorGridLineWidth: 0,
                lineWidth: 2,
                tickPosition: 'inside',
                tickLength: 5,
                tickWidth: 2,
                tickColor: 'black',
                tickAmount: 5,
                labels: {
                    color: '#2d2d2d',
                    style: {
                        "fontWeight": "bold"
                    }
                },
                title: {
                    text: ''
                }
            },
            tooltip: {
                valueDecimals: 1,
            },
            plotOptions: _plotOptions ? {
                series: {
                    marker: {
                        enabled: true
                    }
                }
            } :
                {
                    series: {
                        marker: {
                            enabled: true //PL #1490 Add circular markers on the graphs - Dashrath Prajapati
                        }
                    }
                },
            series: []
        }

        var serLength = _series.length;
        for (var i = 0; i < serLength ; i++) {
            options.series.push(eval(_series[i]));
        }
        $(_linechartDivId).highcharts(options);
    }
    // End:- Linchart script

    // Start:- Linchart script
    function BindLineChartRevenue(_categories, _plotlineVal, _isshowPlotLine, _series, _linechartDivId, _chartHeight, _plotOptions) {
        Highcharts.setOptions({
            lang: {
                numericSymbols: ["k", "M", "B", "T", "P", "E"]
            }
        });
        var options = {
            chart: {
                height: _chartHeight,
                //width: _chartwidth,
                spacingTop: 50
            },
            colors: ['#B04499', '#999999'],
            legend: {
                align: 'left',
                verticalAlign: 'top',
                layout: 'vertical',
                x: 60,
                y: -40
            },
            title: {
                text: ''
            },
            xAxis: {
                categories: _categories,
                lineColor: 'black',
                lineWidth: 2,
                tickColor: 'black',
                tickWidth: 2,
                plotLines: _isshowPlotLine.toLowerCase() == "true" ? [{
                    color: 'black', // Color value
                    dashStyle: 'longdash', // Style of the plot line. Default to solid
                    value: _plotlineVal, // Value of where the line will appear
                    width: 2, // Width of the line
                    label: {
                        text: 'Today',
                        align: 'middle',
                        verticalAlign: 'top',
                        rotation: 0,
                        x: -15,
                        y: -2
                    }
                }] : [],
                tickPosition: 'inside',
                tickmarkPlacement: 'on',
                labels: {
                    color: '#2d2d2d',
                    style: {
                        "fontWeight": "bold"
                    }
                }
            },
            yAxis: {
                lineColor: 'black',
                gridLineWidth: 0,
                minorGridLineWidth: 0,
                lineWidth: 2,
                tickPosition: 'inside',
                tickLength: 5,
                tickWidth: 2,
                tickColor: 'black',
                tickAmount: 5,
                labels: {
                    color: '#2d2d2d',
                    style: {
                        "fontWeight": "bold"
                    }
                },
                title: {
                    text: ''
                }
            },
            tooltip: {
                valueDecimals: 1,
            },
            plotOptions: _plotOptions ? {
                series: {
                    marker: {
                        enabled: true
                    }
                }
            } :
                {
                    series: {
                        marker: {
                            enabled: false
                        }
                    }
                },
            series: []
        }

        var serLength = _series.length;
        for (var i = 0; i < serLength ; i++) {
            options.series.push(eval(_series[i]));
        }
        $(_linechartDivId).highcharts(options);
    }
    // End:- Linchart script

    //Start:- BarLineChart Script
    function BindBarChartData(_categories, _series, _linechartDivId, _title) {
        Highcharts.setOptions({
            lang: {
                numericSymbols: ["k", "M", "B", "T", "P", "E"]
            }
        });
        var options = {
            chart: {
                //height: _height,
                //width: _width,
                type: 'bar'
            },
            title: {
                text: ''
                //style: {
                //    color: '#333',
                //    fontFamily: 'source_sans_proregular',
                //    fontSize: '22px',
                //    fontWeight: 'normal'
                //}
            },
            xAxis: {
                lineWidth: 0,
                categories: _categories,
                gridLineWidth: 0,
                tickWidth: 0
            },
            yAxis: {
                gridLineWidth: 0,
                labels: {
                    enabled: false
                },
                title: {
                    enabled: false
                }
            },
            colors: ['#CCCCCC', '#2384b8'],
            legend: {
                //reversed: true,
                align: 'center',
                verticalAlign: 'top',
                itemDistance: 50,
                symbolPadding: 10,
            },
            plotOptions: {
                series: {
                    //stacking: 'normal',
                    //pointWidth: 40,
                    //pointPadding: 0.1
                },
                scatter: {
                    marker: {
                        symbol: 'line',
                        lineWidth: 3,
                        radius: 12,
                        lineColor: '#F0BE29'
                    }
                },
                bar: {
                    grouping: false,
                    shadow: false,
                    borderWidth: 0
                }
            },
            tooltip: {
                valuePrefix: '$'
            },
            series: []
        }

        var serLength = _series.length;
        var _catLength = _categories.length;
        for (var i = 0; i < serLength ; i++) {
            //alert(eval(_series[i]));
            options.series.push(eval(_series[i]));
            if (_series[i].type != null && _series[i].type != 'undefined' && _series[i].type == 'scatter') {
                var datum = options.series[i];
                datum.tooltip = {
                    shared: true,
                    useHTML: true,
                    headerFormat: '<table>',
                    pointFormat: '<tr><td style="color: {series.color}">{series.name}: </td>' +
                        '<td style="text-align: right"><b>{point.y}</b></td></tr>',
                    footerFormat: '</table>'
                };
                //if (_catLength == 4) {
                //    datum.marker = {
                //        symbol: 'line',
                //        lineWidth: 2,
                //        radius: 26,
                //        lineColor: '#F0BE29'
                //    };
                //}

            }
        }

        Highcharts.Renderer.prototype.symbols.line = function (x, y, width, height) {
            return ['M', x, y + height / 2, 'L', x + width, y + width / 2];
        }
        $(_linechartDivId).highcharts(options);

    }

    function BindRevenueBarChartData(_categories, _series, _linechartDivId) {
        Highcharts.setOptions({
            lang: {
                numericSymbols: ["k", "M", "B", "T", "P", "E"]
            }
        });
        var options = {
            chart: {
                type: 'column'
                //height: _height,
                //width: 400
            },
            colors: ['#B04499', '#999999'],
            title: {
                text: ''
            },
            legend: {
                layout: 'vertical',
                align: 'left',
                verticalAlign: 'top',
                floating: true,
                x: 30,
                y: 45
            },
            xAxis: {
                categories: _categories,
                tickWidth: 0,
                labels: {
                    enabled: false
                }
            },
            yAxis: {
                gridLineWidth: 0,
                labels: {
                    enabled: false
                },
                title: {
                    enabled: false
                }
            },
            credits: {
                enabled: false
            },
            tooltip: {
                valueDecimals: 2,
            },
            plotOptions: {
                series: {
                    //pointWidth: 20,

                    //groupPadding: 0,
                    //borderWidth: 0,
                    //shadow: false
                },
                column: {
                    //grouping: false,
                    shadow: false,
                    borderWidth: 0,
                    pointPadding: 0,
                    pointWidth: 20
                    //groupPadding: 0
                }
            },
            series: []
        }

        var serLength = _series.length;
        // var _catLength = _categories.length;

        for (var i = 0; i < serLength ; i++) {
            //alert(eval(_series[i]));
            options.series.push(eval(_series[i]));
            //if (_series[i].type != null && _series[i].type != 'undefined' && _series[i].type == 'scatter') {
            //    var datum = options.series[i];
            //    datum.tooltip = {
            //        shared: true,
            //        useHTML: true,
            //        headerFormat: '<table>',
            //        pointFormat: '<tr><td style="color: {series.color}">{series.name}: </td>' +
            //            '<td style="text-align: right"><b>{point.y}</b></td></tr>',
            //        footerFormat: '</table>'
            //    };
            //    if (_catLength == 4) {
            //        datum.marker = {
            //            symbol: 'line',
            //            lineWidth: 2,
            //            radius: 26,
            //            lineColor: '#F0BE29'
            //        };
            //    }

            //}
        }

        //Highcharts.Renderer.prototype.symbols.line = function (x, y, width, height) {
        //    return ['M', x, y + height / 2, 'L', x + width, y + width / 2];
        //};
        $(_linechartDivId).highcharts(options);

    }
    //End:- BarLineChart Script

    //Start:- Combination Chart Script
    function BindRevenueCombinationChartData(_categories, _Barseries, _ChartDivId, _linechartseries, _plotlineVal, _pointLabelWidth, _isshowPlotLine, _actulValue) {
        Highcharts.setOptions({
            lang: {
                numericSymbols: ["k", "M", "B", "T", "P", "E"]
            }
        });
        var options = {
            chart: {
                //type: 'column'
                height: 280,
                spacingTop: 30
                //width: 400
            },
            colors: ['#B04499', '#999999', '#006837'],
            title: {
                text: ''
            },
            legend: {
                layout: 'vertical',
                align: 'left',
                verticalAlign: 'top',
                floating: true,
                x: 60,
                y: 45
            },
            xAxis: {
                categories: _categories,
                tickWidth: 0,
                labels: {
                    enabled: false
                },
                plotLines: _isshowPlotLine.toLowerCase() == "true" ? [{  //PL #1394 Revenue to Plan: Today Line for Past & Future Plans : Dashrath Prajapati
                    color: 'black', // Color value
                    dashStyle: 'longdash', // Style of the plot line. Default to solid
                    value: _plotlineVal, // Value of where the line will appear
                    width: 2, // Width of the line
                    label: {
                        text: 'Today',
                        align: 'middle',
                        verticalAlign: 'top',
                        rotation: 0,
                        x: -15,
                        y: -2
                    }
                }] : []
                //plotBands: [{
                //    color: '#ebebeb',
                //    from: _plotBandFrom,
                //    to: _plotBandTo
                //}]
            },
            yAxis: {
                gridLineWidth: 0,
                labels: {
                    enabled: true,
                    align: 'left',
                    x: 7,
                    y: 2
                },
                title: {
                    enabled: false,
                    text: 'Values'
                },
                lineWidth: 1,
                tickPosition: 'inside',
                tickLength: 5,
                tickWidth: 2
            },
            credits: {
                enabled: false
            },
            tooltip: {
                valueDecimals: 2,
            },
            plotOptions: {
                series: {
                    //pointWidth: 20,

                    //groupPadding: 0,
                    //borderWidth: 0,
                    //shadow: false
                },
                column: {
                    //grouping: false,
                    shadow: false,
                    borderWidth: 0,
                    //pointPadding: 5,
                    pointWidth: _pointLabelWidth
                    //groupPadding: 0
                }
            },
            series: []
        }
        var serLength = _Barseries.length;
        var _arractul = [];//add actual list -dashrath
        var _arractulbar = [];//add actual bar list -dashrath
        for (var i = 0; i < serLength ; i++) {
            options.series.push(eval(_Barseries[i]));

            if (_Barseries[i].name == "Actual") {
                _arractulbar.push(_Barseries[i].data);
            }
        }
        var _linechartseriesLength = _linechartseries.length;
        for (var i = 0; i < _linechartseriesLength ; i++) {
            options.series.push(eval(_linechartseries[i]));

            //start #1437 change actual tootlip on waterfall and revenue :- Dashrath Prajapati.

            if (_linechartseries[i].name == "Actual") {
                _arractul.push(_linechartseries[i].data);
            }
            //if (_series[i].type != null && _series[i].type != 'undefined') {
            //    var datum = options.series[i];
            //    datum.tooltip = {
            //        shared: true,
            //        useHTML: true,
            //        headerFormat: '<table>',
            //        pointFormat: '<tr><td style="color: {series.color}">{series.name}: </td>' +
            //            '<td style="text-align: right"><b>{point.y}</b></td></tr> <tr><td style="color: {series.color}">{series.name}: </td>' +
            //    '<td style="text-align: right"><b>{point.y}</b></td></tr>',
            //        footerFormat: '</table>'
            //    };
            //    //if (_catLength == 4) {
            //    //    datum.marker = {
            //    //        symbol: 'line',
            //    //        lineWidth: 2,
            //    //        radius: 26,
            //    //        lineColor: '#F0BE29'
            //    //    };
            //    //}
            //}
        }
        //getting same value in projected and actual
        var sameVal;
        var index;
        var total = 0;
        var ii = 1;
        var arrActual = _arractul;

        var _arrActual = arrActual.toString();
        var Actualarray = _arrActual.split(',');
        var _Actualarray = Actualarray.reverse();

        for (var i = 0; i < _Actualarray.length; i++) {
            if (ii == 1) {
                if (_Actualarray[i].toString() != "") {
                    sameVal = _Actualarray[i].toString();
                    ii++;
                }
            }
        }

        _Actualarray.reverse();
        index = $.inArray(sameVal, _Actualarray);
        if (_Actualarray.length <= 5) {
            for (var i = 0; i <= index - 1; i++) {
                total += _actulValue[i];
            }
        }
        else {
            for (var i = 0; i <= index - 2; i++) {
                total += _actulValue[i];
            }
        }
        _Actualarray.splice(index, 1, total.toString());

        var __Actualarraybar = _arractulbar.toString();
        var _ActualValuebar = __Actualarraybar.split(',')
        options.tooltip = {
            formatter: function () {
                var symbol = '●';
                var series = this.point.series.chart.series[0];
                switch (this.point.graphic.symbolName) {
                    case 'circle':
                        symbol = '●';
                        break;
                    case 'diamond':
                        symbol = '♦';
                        break;
                    case 'square':
                        symbol = '■';
                        break;
                    case 'triangle':
                        symbol = '▲';
                        break;
                    case 'triangle-down':
                        symbol = '▼';
                        break;
                }

                if (this.point.series.name == "Actual") {
                    if (this.point.series.type == "line") {
                        var _point = this.point.series.data.indexOf(this.point);
                        var _val = _Actualarray[_point];
                        return this.key + '<br/><span style="color:' + this.series.color + '">' + symbol + '</span>' + this.point.series.name + ':' + '<b>' + Highcharts.numberFormat(_val) + '</b>';
                    }
                    if (this.point.series.type == "column") {
                        var _point = this.point.series.data.indexOf(this.point);
                        var _val = _ActualValuebar[_point];
                        return this.key + '<br/><span style="color:' + this.series.color + '">' + symbol + '</span>' + this.point.series.name + ':' + '<b>' + Highcharts.numberFormat(_val) + '</b>';
                    }
                }
                else {
                    return this.key + '<br/><span style="color:' + this.series.color + '">' + symbol + '</span>' + this.point.series.name + ':' + '<b>' + Highcharts.numberFormat(this.y) + '</b>';
                }
            }
        };
        //end #1437
        //Highcharts.Renderer.prototype.symbols.line = function (x, y, width, height) {
        //    return ['M', x, y + height / 2, 'L', x + width, y + width / 2];
        //};
        $(_ChartDivId).highcharts(options);
    }
    //End:- Combination Chart Script

    function SaveAsPreset() {

        var IsAnyPlanSelected = $('#ulSelectedPlans').find("li").hasClass("close-list");
        var IsAnyCustomFieldSelected = $('#divCustomFieldsFilter').find("li").hasClass("close-list");
        var IsAnyTTSelected = $('#ulTacticType').find("li").hasClass("close-list");
        var IsAnyStatusSelected = $('#ulStatus').find("li").hasClass("close-list");
        var IsAnyOwnerSelected = $('#ulSelectedOwner').find("li").hasClass("close-list");
        if (!IsAnyCustomFieldSelected && !IsAnyPlanSelected && !IsAnyTTSelected && !IsAnyStatusSelected && !IsAnyOwnerSelected) {
            alert('Please select at least one filter');
            return false;
        }
        else {
            $("#content_SaveFilters").css("display", "block");
            $('#divsidebartoggle').css('display', 'none');//Add By nishant sheth // Desc :: To hide toggle button for preset save filter view
            $("#btnreportSection").css("display", "none");
            $("#Filtersidebar").css("display", "none");


        }

    }

    function ClearAllPreset() {

        //BulkPlanOperation(false);
        $("#ulSelectedPlans li").each(function (i) {
            $(this).removeClass("close-list");
            var chkid = $(this).find("input[type=checkbox]").attr("id");
            $("#" + chkid).removeAttr("checked");
        });

        BulkTTOperation(false);
        //Added by kausha for ticket no #1836
        BulkOwnerOperation(false);
        LoadPlanData(null);
        //Commented by kausha for ticket no #1836
        //BulkStatusOperation(false);
        $('#divCustomFieldsFilter').find("li").each(function (i) {
            $(this).removeClass("close-list");
            var chkid = $(this).find("input[type=checkbox]").attr("id");
            $("#" + chkid).removeAttr("checked");
        });
        $("#accordion-Year li input:checkbox:checked").each(function () {
            $(this).removeAttr("checked");
            $(this).parent().removeClass("close-list");
        });
        UpdateSelectedFilters();
    }

    function LoadPreset() {

        var isLoadPreset = true;
        $.ajax({
            type: 'POST',
            url: '@Url.Action("LastSetOfViews", "Home")',
            data: {
                isLoadPreset: isLoadPreset,
            },
            //dataType: "json",
            async: false,
            success: function (data) {
                if (data != null) {
                    $('#DefaultFilters').css('display', 'block');
                    $('#DefaultFilters').html(data);
                    $('#divsidebartoggle').css('display', 'none');//Add By nishant sheth // Desc :: To hide toggle button for preset save filter view
                }
                else {
                    $('#DefaultFilters').css('display', 'none');
                    $('#divsidebartoggle').css('display', 'block');//Add By nishant sheth // Desc :: To hide toggle button for preset save filter view
                }


            }

        });
        $("#successMessageSidebar").css("display", "none");
        $("#DefaultFilters").css("display", "block");
        $('#divsidebartoggle').css('display', 'none');//Add By nishant sheth // Desc :: To hide toggle button for preset save filter view
        $("#btnreportSection").css("display", "none");
        $("#Filtersidebar").css("display", "none");
        //  $("#displaydata").css("display", "none");

    }

    function SavePreset() {

        var ViewName = $("#txtPresetName").val();
        if (ViewName.trim() == null || ViewName.trim() == "") {
            $("#successMessageSidebar").css("display", "none");
            $('div[id=errorMessageMainSidebar]').each(function () {
                if ($(this).parent().is(':visible')) {
                    $(this).show();
                    $(this).find("span[id=spanErrorMessageRole]").text('@Common.objCached.ProvidePresetName');
                    //  $(this).slideDown(600);
                    //$(this).slideDown(600).delay(3000).slideUp(600);
                }
            });
            $("#txtPresetName").val("");
        }
        else {
            SavePresetValue = true;
            SaveLastSetofViews(ViewName.trim());
            updatedata();


        }


    }

    function CancelSavePreset() {
        $("#txtPresetName").val("");
        $("#errorMessageMainSidebar").css("display", "none");
        $("#successMessageSidebar").css("display", "none");
        $("#successMessageLoadPreset").css("display", "none");
        $("#content_SaveFilters").css("display", "none");
        $("#DefaultFilters").css("display", "none");
        $('#divsidebartoggle').css('display', 'block');//Add By nishant sheth // Desc :: To hide toggle button for preset save filter view
        $("#btnreportSection").css("display", "block");
        $("#Filtersidebar").css("display", "block");
    }
    //Add By Nishant Sheth
    //// Desc :: #1958 Add hide icon to hide side bar
    $('.sidebar-toogle a').toggle(

function () {
    $('#sidebar').css({
        'position': 'relative',
        'left': 'auto',
        'width': '50px',
        'background': 'transparent',

    });
    $(".sidebar-toogle-wrapper h4.text-shadow-black").css("display", "none");
    $(".sidebar-section").css("display", "none");
    $('.sidebar-toogle a').html(">>").css('letter-spacing', '-1px');

    $(".wraper-btns").css("display", "none");
    $("#content_wraper").css('width', 'calc(100% - 51px)');
    $('#sidebar.sidebar').css({ 'width': '50px', 'background': 'transparent', });
    $('.sidebar-toogle').css('border-bottom-width', '0');
    ///Add By Nishant Sheth
    // Desc :: To handle the gridview resize with hide toggle button #1958
    var ganttwidth = $("#gridbox").width();
    if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
        var ganttwidth = $("#gridbox").width();
        var totalWidth = ganttwidth + 230;
        $("#gridbox").attr("width", totalWidth);
        HomeGrid.setSizes();
    }
    // Add by nishant sheth
    // Desc :: To resolve #1958 observation for graph going out side frame
    $(Highcharts.charts).each(function (i, chart) {
        if (chart != undefined) {
            var containerdiv = $($(chart.container).parent());
            if ($(containerdiv).css("display") == "block") {
                var height = containerdiv.height();
                var width = containerdiv.width();
                if (height != undefined && width != undefined && height > 0 && width > 0) {
                    chart.setSize(width, height);
                }
            }
        }
    });

}, function () {
    $('#sidebar').css({
        'position': 'static',
        'left': 'auto',
        //'background': '#e9e9e9 none repeat scroll 0 0', /* Commented for #2219 - Bhumika */
        'width': '280px',

    });
    $('.sidebar-toogle a').html("<< hide").css('letter-spacing', '0px');
    $(".sidebar-toogle-wrapper h4.text-shadow-black").css("display", "block");
    $(".sidebar-section").css("display", "block");
    $(".wraper-btns").css("display", "block");
    $("#content_wraper").css('width', 'calc(100% - 281px)'); //  removed bgcolor, width change for #2219 - Bhumika 
    $('#sidebar.sidebar').css({ 'width': '280px'});
    $('.sidebar-toogle').css('border-bottom-width', '1px');
    ///Add By Nishant Sheth
    // Desc :: To handle the gridview resize with hide toggle button #1958
    var ganttwidth = $("#gridbox").width();
    if (leftPaneOption == '@RevenuePlanner.Helpers.Enums.ReportType.Budget.ToString()') {
        var ganttwidth = $("#gridbox").width();
        var totalWidth = ganttwidth - 230;
        $("#gridbox").attr("width", totalWidth);
        HomeGrid.setSizes();
    }
    // Add by nishant sheth
    // Desc :: To resolve #1958 observation for graph going out side frame
    $(Highcharts.charts).each(function (i, chart) {
        if (chart != undefined) {
            var containerdiv = $($(chart.container).parent());
            if ($(containerdiv).css("display") == "block") {
                var height = containerdiv.height();
                var width = containerdiv.width();
                if (height != undefined && width != undefined && height > 0 && width > 0) {
                    chart.setSize(width, height);
                }
            }
        }
    });

    
});
    // End By Nishant Sheth
    // Add By Nishant Sheth
    // Desc :: #2262 call particular dashboard 
    $('li[id^="CustomReportli"]').click(function () {
        // Add By Nishant Sheth
        // #2257 : set selected custom report tab and it's option
        leftPaneOption = '@RevenuePlanner.Helpers.Enums.ReportType.Custom.ToString()'
        RemoveAllActiveItem();
        $('#liCustomReport').addClass('active');
        $.each($('li[id^="CustomReportli"]'), function () {
            if ($(this).hasClass('selected')) {
                $(this).removeClass('selected');
            }
        });
        document.title = "Custom";
        $(this).addClass('selected');
        $('#ddlsection').hide(); 
        $('#ddlCustomTimeFrame').show(); 
        var DashboardLink = $(this).find('a');
        if (DashboardLink != null && DashboardLink != undefined && DashboardLink != 'undefined')
        {
            var CustomUrlLink = $(DashboardLink).text().trim();
            $("#dashboardpagetext").text(CustomUrlLink);
        }
        
        // End By Nishant Sheth
        var DashboardID = $(this).attr('id').replace('CustomReportli', '');
        var url = '@Url.Content("~/Report/GetCustomReport/")';
        $.ajax({
            type: 'POST',
            url: url,
            data: {
                DashboardId: DashboardID
            },
            success: function (response) {
                $('#divMainReportPart').html('');
                $('#divMainReportPart').html(response);
                isAllowClick = true;
                if ($(".popover.fade.top.in").length != 0) {
                    $(".popover.fade.top.in").remove();
                }
            }
        });
    });

</script>
