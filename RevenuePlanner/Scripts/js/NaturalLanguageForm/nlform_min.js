!function(t){"use strict";function e(t){this.el=t,this.overlay=this.el.querySelector(".nl-overlay"),this.fields=[],this.fldOpen=-1,this._init()}function i(t,e,i,n){this.form=t,this.elOriginal=e,this.pos=n,this.type=i,this._create(),this._initEvents()}var n=t.document;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.prototype={_init:function(){var t=this;Array.prototype.slice.call(this.el.querySelectorAll("select")).forEach(function(e,n){t.fldOpen++,t.fields.push(new i(t,e,"dropdown",t.fldOpen))}),Array.prototype.slice.call(this.el.querySelectorAll("input")).forEach(function(e,n){t.fldOpen++,t.fields.push(new i(t,e,"input",t.fldOpen))});try{this.overlay.addEventListener("click",function(e){t._closeFlds()}),this.overlay.addEventListener("touchstart",function(e){t._closeFlds()})}catch(e){}$(".priceValue").priceFormat({prefix:"",centsSeparator:"",thousandsSeparator:",",centsLimit:0}),$(".currency_dollar").priceFormat({prefix:htmlDecode(CurrencySybmol),centsSeparator:"",thousandsSeparator:",",centsLimit:0}),$(".dollarValue").priceFormat({prefix:"",centsSeparator:"",thousandsSeparator:",",centsLimit:0}),$(".percentValue").priceFormat({prefix:"",suffix:"%",centsSeparator:"",thousandsSeparator:",",centsLimit:0,isDouble:!0})},_closeFlds:function(){-1!==this.fldOpen&&this.fields[this.fldOpen].close()}},i.prototype={_create:function(){"dropdown"===this.type?this._createDropDown():"input"===this.type&&this._createInput()},_createDropDown:function(){var t=this;if(this.fld=n.createElement("div"),this.fld.className="nl-field nl-dd",this.toggle=n.createElement("a"),this.toggle.innerHTML=this.elOriginal.options[this.elOriginal.selectedIndex].innerHTML,this.elOriginal.hasAttribute("maxlength")){var e=this.elOriginal.getAttribute("maxlength");e.length>0&&this.toggle.innerHTML.length>e&&(this.toggle.title=$("<div/>").html(this.toggle.innerHTML).text(),this.toggle.innerHTML=this.toggle.innerHTML.substring(0,e)+"...")}this.toggle.className="nl-field-toggle",this.optionsList=n.createElement("ul");var i="";Array.prototype.slice.call(this.elOriginal.querySelectorAll("option")).forEach(function(e,n){var l;e.hasAttribute("value")&&(l=e.getAttribute("value"));var s=e.innerHTML,r=!1;s.length>30&&(r=!0,s=e.innerHTML.substring(0,30)+"..."),i+="<li",t.elOriginal.selectedIndex===n&&(i+=' class="nl-dd-checked"',t.selectedIdx=n),r&&(i+=' title="'+e.innerHTML+'"'),i+=' value="'+l+'" originalValue="'+e.innerHTML+'" TextValue="'+l+'">'+s+"</li>"}),this.optionsList.innerHTML=i,this.optionsList.setAttribute("style","overflow:auto; max-height: 350px;"),this.fld.appendChild(this.toggle),this.fld.appendChild(this.optionsList),this.elOriginal.parentNode.insertBefore(this.fld,this.elOriginal),this.elOriginal.style.display="none"},_createInput:function(){this.fld=n.createElement("div"),this.fld.className="nl-field nl-ti-text",this.toggle=n.createElement("a");var t=this.elOriginal.getAttribute("placeholder"),e=t,i=this.elOriginal.getAttribute("formatType");("priceValue"==i||"dollarValue"==i)&&(e=FormatCommas(t,!1)),"currency_dollar"==i&&(e=FormatCurrency(t,!1)),"percentValue"==i&&(e=FormatPercent(t,!0)),e=htmlDecode(e);var l=e;l.length>15?(this.toggle.setAttribute("title",l),l=l.substring(0,15)+"..."):this.toggle.removeAttribute("title"),this.toggle.innerHTML=l,this.toggle.className="nl-field-toggle",this.optionsList=n.createElement("ul"),this.getinput=n.createElement("input"),this.getinput.setAttribute("type","text"),this.getinput.setAttribute("placeholder",e),this.getinput.setAttribute("maxlength",this.elOriginal.getAttribute("maxlength"));var s=this.elOriginal.getAttribute("isedit");null!=s&&"undefined"!=s&&""!=s&&"true"==s.toLowerCase()?this.getinput.setAttribute("value",e):this.getinput.setAttribute("value",""),this.getinput.setAttribute("onblur","getblurvalue(this);"),this.getinput.setAttribute("onfocus","OnNLTextFocus(this);"),this.getinput.setAttribute("class",i),this.getinputWrapper=n.createElement("li"),this.getinputWrapper.className="nl-ti-input",this.inputsubmit=n.createElement("button"),this.inputsubmit.className="nl-field-go",this.inputsubmit.innerHTML="Go",this.getinputWrapper.appendChild(this.getinput),this.getinputWrapper.appendChild(this.inputsubmit),this.example=n.createElement("li"),this.example.className="nl-ti-example",this.example.innerHTML=this.elOriginal.getAttribute("datasubline"),this.optionsList.appendChild(this.getinputWrapper),this.optionsList.appendChild(this.example),this.fld.appendChild(this.toggle),this.fld.appendChild(this.optionsList),this.elOriginal.parentNode.insertBefore(this.fld,this.elOriginal),this.elOriginal.style.display="none"},_initEvents:function(){var t=this;if(this.toggle.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t._open()}),this.toggle.addEventListener("touchstart",function(e){e.preventDefault(),e.stopPropagation(),t._open()}),"dropdown"===this.type){var e=Array.prototype.slice.call(this.optionsList.querySelectorAll("li"));e.forEach(function(i,n){i.addEventListener("click",function(n){n.preventDefault(),t.close(i,e.indexOf(i))}),i.addEventListener("touchstart",function(n){n.preventDefault(),t.close(i,e.indexOf(i))})})}else"input"===this.type&&(this.getinput.addEventListener("keydown",function(e){13==e.keyCode&&t.close()}),this.inputsubmit.addEventListener("click",function(e){e.preventDefault(),t.close()}),this.inputsubmit.addEventListener("touchstart",function(e){e.preventDefault(),t.close()}))},_open:function(){if(this.open)return!1;this.open=!0,this.form.fldOpen=this.pos;this.fld.className+=" nl-field-open"},close:function(t,e){if(!this.open)return!1;if(this.open=!1,this.form.fldOpen=-1,this.fld.className=this.fld.className.replace(/\b nl-field-open\b/,""),"dropdown"===this.type){if(t){var i=this.optionsList.children[this.selectedIdx];if(i.className="",t.className="nl-dd-checked",this.toggle.innerHTML=t.getAttribute("originalValue"),this.selectedIdx=e,this.elOriginal.value=this.elOriginal.children[this.selectedIdx].value,this.toggle.removeAttribute("title"),this.elOriginal.hasAttribute("maxlength")){var n=this.elOriginal.getAttribute("maxlength");n.length>0&&this.toggle.innerHTML.length>n&&(this.toggle.title=this.toggle.innerHTML,this.toggle.innerHTML=this.toggle.innerHTML.substring(0,n)+"...")}}}else if("input"===this.type){this.getinput.blur(),this.elOriginal.value=this.getinput.value;var l=this.getinput.value;l.length>15?(this.toggle.setAttribute("title",l),l=l.substring(0,15)+"..."):this.toggle.removeAttribute("title"),this.toggle.innerHTML=""!==this.getinput.value.trim()?l:this.getinput.getAttribute("placeholder")}}},t.NLForm=e}(window);